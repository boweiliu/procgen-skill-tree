{"version":3,"sources":["bunny.png","lib/pixi/keyboard.ts","lib/util/fpsTracker.ts","lib/pixi/DraggableHelper.ts","pixi/Application.ts","components/PixiComponent.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["module","exports","KeyInfoMap","m","Q","W","E","R","T","Y","U","I","O","P","A","S","D","F","G","H","J","K","L","Z","X","C","V","B","N","M","Up","Down","Left","Right","Shift","Spacebar","Enter","Object","keys","KeyboardState","down","justDown","justUp","_queuedEvents","document","addEventListener","e","keyDown","keyUp","window","clear","this","push","event","isDown","str","length","toUpperCase","slice","key","formatKeyString","number","keyCode","which","String","fromCharCode","queuedEvent","eventToKey","console","log","FpsTracker","frameTimestampsInTicks","frameTimestampsInTime","ticksSinceLastUpdate","lastFrameTime","logRowsToKeep","Date","getTime","ticksDiff","framesPerTick","timeDiff","framesPerMilli","getFps","toFixed","getUps","DraggableHelper","args","sourceContainer","targetContainer","targetStartingX","targetStartingY","mouseStartingX","mouseStartingY","data","isDragging","onDragStart","x","y","startingPosition","getLocalPosition","onDragEnd","onDragMove","localPosition","source","target","interactive","addListener","defaultConfig","canvasWidth","canvasHeight","application","config","app","stage","fixedCameraStage","actionStage","backdropStage","fpsTracker","assign","Pixi","width","height","antialias","backgroundColor","sortableChildren","zIndex","addChild","keyboard","ticker","add","delta","update","tick","textFpsHud","text","getFpsString","getUpsString","curr","appendChild","view","viewport","pixiExample","backdrop","beginFill","drawRect","reticle","lineStyle","drawCircle","container","texture","from","bunny","alert","i","anchor","set","Math","floor","screen","pivot","rotation","PixiComponent","props","useRef","useEffect","register","current","drawStart","ref","onClick","App","className","Boolean","location","hostname","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.c5cfc136.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAlCAYAAABcZvm2AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAWNJREFUeNrsV8sNwjAMbUqBBWACxB2pQ8AKcGALTsAJuDEFB1gBhuDAuWICmICPQh01pXWdJqEFcaglRGRbfonjPLuMc+5QwhjLGEJfZusjxZOL9akZKye9G98vPMfvsAx4qBfKwfzBL9s6uUHpI6U/u7+BKGkNb/H6umtk7MczF0HyfKS4zo/k/4AgTV8DOizrqX8oECgC+MGa8lGJp9sJDiAB8nyqYoglvJOPbP97IqoATGxWVZeXJlMQwYHA3piF8wJIblOVNBBxe3TPMLoHIKtxrbS7AAbBrA4Y5NaPAXf8LjN6wKZ0RaZOnlAFZnuXInVR4FTE6eYp0olPhhshtXsAwY3PquoAJNkIY33U7HTs7hYBwV24ItUKqDwgKF3VzAZ6k8HF+B1BMF8xRJbeJoqMXHZAAQ1kwoluURCdzepEugGEImBrIADB7I4lyfbJLlw92FKE6b5hVd+ktv4vAQYASMWxvlAAvcsAAAAASUVORK5CYII=\"","const KeyInfo = () => ({\n  Q       : false,\n  W       : false,\n  E       : false,\n  R       : false,\n  T       : false,\n  Y       : false,\n  U       : false,\n  I       : false,\n  O       : false,\n  P       : false,\n  A       : false,\n  S       : false,\n  D       : false,\n  F       : false,\n  G       : false,\n  H       : false,\n  J       : false,\n  K       : false,\n  L       : false,\n  Z       : false,\n  X       : false,\n  C       : false,\n  V       : false,\n  B       : false,\n  N       : false,\n  M       : false,\n  Up      : false,\n  Down    : false,\n  Left    : false,\n  Right   : false,\n  Shift   : false,\n  Spacebar: false,\n  Enter   : false,\n});\n\nconst KeyInfoMap = (() => {\n  let m = KeyInfo();\n  for (let k of Object.keys(m)) {\n    m[k as keyof KeyInfoType] = true;\n  }\n  return m;\n})();\n\nexport type KeyInfoType = ReturnType<typeof KeyInfo>;\n\ninterface QueuedKeyboardEvent {\n  isDown: boolean;\n  event : KeyboardEvent;\n}\n\nexport class KeyboardState {\n  public down     = KeyInfo();\n  public justDown = KeyInfo();\n  public justUp   = KeyInfo();\n\n  private _queuedEvents: QueuedKeyboardEvent[] = [];\n\n  constructor() {\n    document.addEventListener(\"keydown\", e => this.keyDown(e), false);\n    document.addEventListener(\"keyup\"  , e => this.keyUp(e),   false);\n    window.addEventListener(\"blur\"     , () => { \n      this.clear();\n    }, false);\n  }\n\n  public clear() {\n    this.down          = KeyInfo(); \n    this.justDown      = KeyInfo(); \n    this.justUp        = KeyInfo(); \n    this._queuedEvents = [];\n  }\n\n  private keyUp(e: KeyboardEvent): void {\n    // Since events usually happen between two ticks, we queue them up to be\n    // processed on the next tick.\n\n    this._queuedEvents.push({ event: e, isDown: false });\n  }\n\n  private keyDown(e: KeyboardEvent): void {\n    this._queuedEvents.push({ event: e, isDown: true });\n  }\n\n  private formatKeyString(str: string): string {\n    if (str === \" \") {\n      return \"Spacebar\";\n    }\n\n    if (str.length === 1) {\n      return str.toUpperCase();\n    }\n    if (str.slice(0, 5) === \"Arrow\") {\n      return str.slice(5);\n    }\n\n    return str[0].toUpperCase() + str.slice(1);\n  }\n\n  private eventToKey(event: KeyboardEvent): string {\n    // prefer event.key\n    let str: string = event.key;\n    str = this.formatKeyString(str);\n    if (str) {\n      return str;\n    }\n    // use keycode or which if they are supported, and convert them to key string\n    const number = event.keyCode || event.which;\n\n    switch (number) {\n      case 13: str = \"Enter\"; break;\n      case 16: str = \"Shift\"; break;\n      case 37: str = \"Left\" ; break;\n      case 38: str = \"Up\"   ; break;\n      case 39: str = \"Right\"; break;\n      case 40: str = \"Down\" ; break;\n\n      /* A-Z */\n      default: str = String.fromCharCode(number);\n    }\n    return this.formatKeyString(str);\n  }\n\n  update(): void {\n    for (const key of Object.keys(this.justDown)) {\n      this.justDown[key as keyof KeyInfoType] = false;\n      this.justUp[key as keyof KeyInfoType] = false;\n    }\n\n    for (const queuedEvent of this._queuedEvents) {\n      const key = this.eventToKey(queuedEvent.event);\n      if (!KeyInfoMap[key as keyof KeyInfoType]) {\n        console.log(\"got unrecognized keypress: [\", key,\"]\", queuedEvent) // DEBUG\n      }\n\n      if (queuedEvent.isDown) {\n        if (!this.down[key as keyof KeyInfoType]) {\n          this.justDown[key as keyof KeyInfoType] = true;\n        }\n\n        this.down[key as keyof KeyInfoType] = true;\n      } else {\n        if (this.down[key as keyof KeyInfoType]) {\n          this.justUp[key as keyof KeyInfoType] = true;\n        }\n        \n        this.down[key as keyof KeyInfoType] = false;\n      }\n    }\n\n    this._queuedEvents = [];\n  }\n}","\nconst logRowsToKeep: number = 60; // last 1 seconds, at 60 fps\n\nexport class FpsTracker {\n  private frameTimestampsInTicks: any[] = [];\n  private frameTimestampsInTime: any[] = [];\n\n  constructor() {\n    this.frameTimestampsInTicks.push(0);\n    // this.frameTimestampsInTime.push((new Date()).getTime());\n  }\n\n  public tick(ticksSinceLastUpdate: number) {\n    let lastFrameTime = this.frameTimestampsInTicks[this.frameTimestampsInTicks.length - 1];\n    this.frameTimestampsInTicks.push(lastFrameTime + ticksSinceLastUpdate);\n    \n    // rotate logs\n    if (this.frameTimestampsInTicks.length > logRowsToKeep + 60) {\n      this.frameTimestampsInTicks = this.frameTimestampsInTicks.slice(60);\n    }\n\n    // do the same but track real time\n    this.frameTimestampsInTime.push((new Date()).getTime());\n    if (this.frameTimestampsInTime.length > logRowsToKeep + 60) {\n      this.frameTimestampsInTime = this.frameTimestampsInTime.slice(60);\n    }\n  }\n\n  // [0, 3, 4] -> 30 fps\n  public getUps() : number {\n    let ticksDiff = this.frameTimestampsInTicks[this.frameTimestampsInTicks.length - 1] - this.frameTimestampsInTicks[0];\n    let framesDiff = this.frameTimestampsInTicks.length - 1;\n\n    let framesPerTick = framesDiff / ticksDiff;\n    if (!framesPerTick) {\n      return 60;\n    }\n\n    return framesPerTick * 60;\n  }\n\n  public getFps(): number {\n    let timeDiff = this.frameTimestampsInTime[this.frameTimestampsInTime.length - 1] - this.frameTimestampsInTime[0];\n    let framesDiff = this.frameTimestampsInTime.length - 1;\n\n    let framesPerMilli = framesDiff / timeDiff;\n    if (!framesPerMilli) {\n      return 60;\n    }\n\n    return framesPerMilli * 1000;\n  }\n\n  public getFpsString(): string {\n    let fpsNumber = this.getFps();\n\n    return fpsNumber.toFixed(1);\n  }\n\n  public getUpsString(): string {\n    let upsNumber = this.getUps();\n\n    return upsNumber.toFixed(1);\n  }\n}","import { InteractionData } from \"pixi.js\";\n\n\n/**\n * NOTE: on mobile multitouch, runs into issues when:\n * 1. hold 1 finger down and move it around (works)\n * 2. put down another finger (note that the newest finger controls the drag)\n * 3. release the second finger\n * 4. the first finger (which is the only \"down\" finger) no longer controls drag!!! bad!!!\n */\nexport class DraggableHelper {\n  private sourceContainer!: PIXI.Container\n  private targetContainer!: PIXI.Container\n  private targetStartingX!: number;\n  private targetStartingY!: number;\n  private mouseStartingX!: number;\n  private mouseStartingY!: number;\n  private data!: InteractionData // TODO(bowei): what is this\n  private isDragging: boolean = false;\n  // private dragRatio: number = 1;\n\n  constructor(args: {\n    source: PIXI.Container,\n    target: PIXI.Container,\n  }) {\n    let { source, target } = args;\n    source.interactive = true;\n\n    // this.dragRatio = ratio;\n    this.sourceContainer = source;\n    this.targetContainer = target;\n\n    source.addListener('pointerdown', this.onDragStart);\n\n    source.addListener('pointerup', this.onDragEnd);\n    source.addListener('pointerupoutside', this.onDragEnd);\n\n    source.addListener('pointermove', this.onDragMove);\n  }\n\n  private onDragStart = (event: PIXI.InteractionEvent) => {\n    this.data = event.data;\n    this.targetStartingX = this.targetContainer.x;\n    this.targetStartingY = this.targetContainer.y;\n    const startingPosition = this.data.getLocalPosition(this.sourceContainer)\n    this.mouseStartingX = startingPosition.x;\n    this.mouseStartingY = startingPosition.y;\n\n    console.log(this);\n    this.isDragging = true;\n  }\n\n  private onDragEnd = () => {\n    this.isDragging = false;\n  }\n\n  private onDragMove = () => {\n    if (this.isDragging) {\n      // wtf??\n      const localPosition = this.data.getLocalPosition(this.sourceContainer);\n      this.targetContainer.x = this.targetStartingX + (localPosition.x - this.mouseStartingX);\n      this.targetContainer.y = this.targetStartingY + (localPosition.y - this.mouseStartingY);\n    }\n  }\n}\n\nexport function registerDraggable(args: {\n    source: PIXI.Container,\n    target: PIXI.Container,\n    ratio?: number\n}) : DraggableHelper {\n  return new DraggableHelper(args);\n}","import * as Pixi from \"pixi.js\";\nimport { Rect } from \"../lib/util/geometry/rect\";\nimport bunny from \"../bunny.png\";\nimport { KeyboardState } from \"../lib/pixi/keyboard\";\nimport { FpsTracker } from \"../lib/util/fpsTracker\";\nimport { registerDraggable } from \"../lib/pixi/DraggableHelper\";\n\nexport type Config = {\n  canvasWidth: number;\n  canvasHeight: number;\n};\n\nconst defaultConfig: Config = {\n  canvasWidth: 800,\n  canvasHeight: 800,\n};\n\nexport type Point = number[];\n\nexport class Application {\n  public app!: Pixi.Application;\n\n  // root container\n  public stage!: Pixi.Container;\n  // Contains HUD, and other entities that don't move when game camera moves\n  public fixedCameraStage!: Pixi.Container;\n  // Contains game entities that move when game camera pans/zooms. Highly encouraged to have further subdivions.\n  public actionStage!: Pixi.Container;\n  // Contains a few entities that doesn't move when game camera moves, but located behind action stage entities, e.g. static backgrounds\n  public backdropStage!: Pixi.Container;\n\n  public config!: Config;\n\n  public fpsTracker: FpsTracker;\n\n  /**\n   * Need to provide config to set up the pixi canvas\n   */\n  constructor(config?: Config, app?: Pixi.Application) {\n    this.config = Object.assign({}, defaultConfig, config);\n\n    this.app =\n      app ||\n      new Pixi.Application({\n        width: this.config.canvasWidth,\n        height: this.config.canvasHeight,\n        antialias: true,\n        backgroundColor: 0xffffff, // immaterial - we recommend setting color in backdrop graphics\n      });\n\n    this.stage = this.app.stage;\n    this.stage.sortableChildren = true;\n\n    this.fixedCameraStage = new Pixi.Sprite();\n    this.fixedCameraStage.zIndex = 1;\n    this.fixedCameraStage.sortableChildren = true;\n    this.stage.addChild(this.fixedCameraStage);\n\n    this.actionStage = new Pixi.Sprite();\n    this.actionStage.zIndex = 0;\n    this.actionStage.sortableChildren = true;\n    this.stage.addChild(this.actionStage);\n\n    this.backdropStage = new Pixi.Sprite();\n    this.backdropStage.zIndex = -1;\n    this.backdropStage.sortableChildren = true;\n    this.stage.addChild(this.backdropStage);\n    registerDraggable({\n      source: this.backdropStage,\n      // dragging backdrop stage should move action stage in the reverse direction -- we're dragging the backdrop, not an entity\n      target: this.actionStage,\n    });\n\n    const keyboard = new KeyboardState();\n    this.app.ticker.add((delta) => {\n      keyboard.update();\n      if (keyboard.down.Right) {\n        this.actionStage.x -= 10 * delta;\n      }\n      if (keyboard.down.Left) {\n        this.actionStage.x += 10 * delta;\n      }\n      if (keyboard.down.Up) {\n        this.actionStage.y += 10 * delta;\n      }\n      if (keyboard.down.Down) {\n        this.actionStage.y -= 10 * delta;\n      }\n    });\n\n    this.fpsTracker = new FpsTracker();\n    this.app.ticker.add((delta) => {\n      // delta should be approximately equal to 1\n      this.fpsTracker.tick(delta);\n    })\n\n    // put a text thingy in the top right\n    let textFpsHud = new Pixi.Text('');\n    this.app.ticker.add(() => {\n      textFpsHud.text = this.fpsTracker.getFpsString() + \" FPS\\n\" + this.fpsTracker.getUpsString() + \" UPS\";\n    })\n    textFpsHud.x = 600;\n    textFpsHud.y = 200;\n    this.fixedCameraStage.addChild(textFpsHud);\n\n  }\n\n  /**\n   * Please only call once!!\n   * Usage: const container = useRef<HTMLDivElement>(null); useEffect(() => { application.register(container.current!); }, []);\n   */\n  public register(curr: HTMLDivElement) {\n    curr.appendChild(this.app.view);\n  }\n\n  /**\n   * Draws a full skill tree at the default zoom level.\n   */\n  public drawAll() {\n    // get the first 3 layers' configurations\n    // render the top layer points\n    // renderLayerPoints(layer[0], { rect: null })\n    // render the next layer\n    // render the intermediate connections\n    // render the final layer\n    // render the intermediate connections\n  }\n\n  /**\n   * Used for panning/zooming.\n   */\n  public moveViewport(viewport: Rect) {}\n\n  public drawStart() {\n    // this.renderRects.drawFirst();\n    this.pixiExample();\n    \n    // add an invisible layer to the entire fixedCameraStage so we can pan and zoom\n    const backdrop = new Pixi.Graphics();\n    this.backdropStage.addChild(backdrop);\n    backdrop.beginFill(0xabcdef, 1);\n    // backdrop.alpha = 0.5;\n    backdrop.interactive = true;\n    // backdrop.interactiveChildren = true;\n    // backdrop.zIndex = 31;\n    // backdrop.buttonMode = true;\n    // backdrop.drawRect(0, 0, this.config.canvasWidth, this.config.canvasHeight);\n    backdrop.drawRect(-10000, -10000, 20000, 20000);\n    // backdrop.addListener('pointerupoutside', e => {\n    //   console.log('clickable hud', e)\n    // })\n    // backdrop.addListener('pointerup', (e) => {\n    //   // window.alert('up from clickable hud');\n    //   console.log('clickable hud', e)\n    // })\n\n    const reticle = new Pixi.Graphics();\n    this.fixedCameraStage.addChild(reticle);\n\n    reticle.lineStyle(2, 0x999999);\n    reticle.drawCircle(this.config.canvasWidth / 2, this.config.canvasHeight / 2, 10);\n    reticle.interactive = true;\n  }\n\n  public drawCircle() {\n  }\n\n  public pixiExample() {\n    // Taken from  https://pixijs.io/examples/#/demos-basic/container.js\n    const container = new Pixi.Container();\n\n    this.actionStage.addChild(container);\n\n    // Create a new texture\n    const texture = Pixi.Texture.from(bunny);\n\n    window.alert(\"doing bunny stuff\")\n\n    // Create a 5x5 grid of bunnies\n    for (let i = 0; i < 25; i++) {\n      const bunny = new Pixi.Sprite(texture);\n      bunny.anchor.set(0.5);\n      bunny.x = (i % 5) * 40;\n      bunny.y = Math.floor(i / 5) * 40;\n      container.addChild(bunny);\n      bunny.interactive = true;\n      // bunny.addListener('pointerdown', () => {\n      //   window.alert('clicked bunny #' + i);\n      // });\n    }\n\n    // Move container to the center\n    container.x = this.app.screen.width / 2;\n    container.y = this.app.screen.height / 2;\n\n    // Center bunny sprite in local container coordinates\n    container.pivot.x = container.width / 2;\n    container.pivot.y = container.height / 2;\n\n    // Listen for animate update\n    this.app.ticker.add((delta) => {\n      // rotate the container!\n      // use delta to create frame-independent transform\n      container.rotation -= 0.01 * delta;\n    });\n  }\n}\n","import React, { useEffect, useRef, useState } from \"react\";\nimport \"./PixiComponent.css\";\nimport { Application } from \"../pixi/Application\";\n\n/**\n * Initialize the pixi app\n */\n// const game = new BaseGame({\n//   scale: 1,\n//   canvasWidth: 800,\n//   canvasHeight: 800,\n//   tileHeight: 16,\n//   tileWidth: 16,\n//   debugFlags: {},\n//   state: {\n//     tick: 0,\n//   },\n//   backgroundColor: 0xffffff, // TODO(bowei): fix this\n// });\nconst application = new Application();\n\nexport function PixiComponent(props: { whatever?: any }) {\n  const container = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    application.register(container.current!);\n    // container.current!.appendChild(application.app.view)\n\n    application.drawStart();\n  }, []);\n\n  return (\n    <>\n      <div ref={container} />\n      <button onClick={() => application.drawCircle()}>draw circle</button>\n      <button onClick={() => application.drawStart()}>rerender all</button>\n    </>\n  );\n}\n","import React from \"react\";\nimport \"./App.css\";\nimport { PixiComponent } from \"./components/PixiComponent\";\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      Hi stuff is here\n      {/* <header className=\"App-header\">\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\n        <p>\n          Edit <code>src/App.tsx</code> and save to reload.\n        </p>\n        <a\n          className=\"App-link\"\n          href=\"https://reactjs.org\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          Learn React\n        </a>\n  </header> */}\n      <PixiComponent />\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://bit.ly/CRA-PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See https://bit.ly/CRA-PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { \"Service-Worker\": \"script\" },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}