(this["webpackJsonpprocgen-skill-tree"]=this["webpackJsonpprocgen-skill-tree"]||[]).push([[0],{130:function(e,t,n){},131:function(e,t,n){},132:function(e,t,n){},142:function(e,t){},144:function(e,t){},155:function(e,t){},157:function(e,t){},182:function(e,t){},184:function(e,t){},185:function(e,t){},190:function(e,t){},192:function(e,t){},211:function(e,t){},223:function(e,t){},226:function(e,t){},229:function(e,t,n){},230:function(e,t,n){},231:function(e,t,n){},232:function(e,t,n){"use strict";n.r(t);var i,o=n(0),a=n(5),r=n.n(a),s=n(120),c=n.n(s),u=(n(130),n(10)),d=(n(131),n(44)),l=n.n(d),h=n(121),p=n.n(h),v=n(3),f=n(7),y=n(2),b=function e(){Object(y.a)(this,e)};b.CHUNK_HALF_DIM=((b.CHUNK_DIM=9)-1)/2,b.DROP_NODES_CHANCE=.3,function(e){e.Mana0="Mana0",e.Mana1="Mana1",e.Mana2="Mana2"}(i||(i={}));var j,k=Object(f.a)({Nothing:"Nothing"},i);!function(e){e.Flat="Flat",e.Increased0="% increased",e.AfterIncreased0="added after % increased",e.Increased1="% increased multiplier",e.AfterIncreased1="added after % increased multiplier"}(j||(j={}));var S=function(){function e(t){Object(y.a)(this,e),this.z=void 0,this.chunkCoord=void 0,this.pointNodeCoord=void 0,this.pointNodeId=void 0,this.z=t.z,this.chunkCoord=t.chunkCoord,this.pointNodeCoord=t.pointNodeCoord,this.pointNodeId=t.pointNodeId}return Object(v.a)(e,[{key:"hash",value:function(){return this.pointNodeId.toString()+this.z.toString()+this.chunkCoord.toString()+this.pointNodeCoord.toString()}}]),e}(),g=function(){function e(t){Object(y.a)(this,e),this.z=void 0,this.chunkCoord=void 0,this.chunkId=void 0,this.z=t.z,this.chunkCoord=t.chunkCoord,this.chunkId=t.chunkId}return Object(v.a)(e,[{key:"hash",value:function(){return this.chunkId.toString()+this.z.toString()+this.chunkCoord.toString()}}]),e}(),O=function(){function e(t){Object(y.a)(this,e),this.type=void 0,this.modifier=void 0,this.type=t.type,this.modifier=t.modifier}return Object(v.a)(e,[{key:"hash",value:function(){return this.type.toString()+","+this.modifier.toString()}}]),e}(),x=n(9),w=function(){function e(){Object(y.a)(this,e)}return Object(v.a)(e,null,[{key:"MinBy",value:function(e,t){var n,i=null,o=null,a=Object(x.a)(e);try{for(a.s();!(n=a.n()).done;){var r=n.value,s=t(r);(null===o||s<o)&&(i=r,o=s)}}catch(c){a.e(c)}finally{a.f()}return i}},{key:"MinByAndValue",value:function(e,t){var n,i=null,o=null,a=Object(x.a)(e);try{for(a.s();!(n=a.n()).done;){var r=n.value,s=t(r);(null===o||s<o)&&(i=r,o=s)}}catch(c){a.e(c)}finally{a.f()}return null===i||null===o?null:{obj:i,value:o}}},{key:"MaxBy",value:function(e,t){var n,i=null,o=null,a=Object(x.a)(e);try{for(a.s();!(n=a.n()).done;){var r=n.value,s=t(r);(null===o||s>o)&&(i=r,o=s)}}catch(c){a.e(c)}finally{a.f()}return i}},{key:"RandRange",value:function(e,t){return Math.floor(Math.random()*(t-e)+e)}},{key:"SortByKey",value:function(e,t){return e.sort((function(e,n){return t(e)-t(n)}))}},{key:"ReplaceAll",value:function(e,t){var n=new RegExp(Object.keys(t).join("|"),"gi");return e.replace(n,(function(e){return t[e.toLowerCase()]}))}},{key:"Debounce",value:function(e){var t,n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{isImmediate:!1},a=function(){for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];var c=function(){t=void 0,o.isImmediate||e.apply(n,r)},u=o.isImmediate&&void 0===t;void 0!==t&&clearTimeout(t),t=setTimeout(c,i),u&&e.apply(n,r)};return a}},{key:"FormatDate",value:function(e){var t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()];return"".concat(t," ").concat(e.getDate(),", ").concat(("00"+e.getHours()).substr(-2),":").concat(("00"+e.getMinutes()).substr(-2),":").concat(("00"+e.getSeconds()).substr(-2))}},{key:"FlattenByOne",value:function(e){var t,n=[],i=Object(x.a)(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;n=n.concat(o)}}catch(a){i.e(a)}finally{i.f()}return n}},{key:"PadString",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:" ";return e+n+i.repeat(t-e.length)}}]),e}(),m={};function N(e){var t=e.toString();if(void 0!==m[t]){if(1!==m[t][1])throw new Error("Error, called more than twice with same id: "+t+" , callback the first time was : "+m[t]);m[t][1]=2}else{var n=(new Error).stack;m[t]=[n,1]}}var C,I=function(){function e(t){Object(y.a)(this,e),this._wasConstructed=!1,this._value=void 0,this._factory=void 0,this._factory=t}return Object(v.a)(e,[{key:"get",value:function(){return void 0!==this._value||!0===this._wasConstructed||(this._value=this._factory(),this._wasConstructed=!0),this._value}}]),e}();function z(e,t){var n=[16711680&e,16711680&t],i=[255&e,255&t],o=[65280&e,65280&t],a=65536*Math.round(n[0]/65536*n[1]/16777215);return a+=256*Math.round(o[0]/256*o[1]/65280),a+=Math.round(i[0]*i[1]/255)}function _(e){return Object.keys(e)}function P(e,t){var n,i=function(e,t){var n={},i=t.zLevels[e.z],o=i.chunks.get(e.chunkCoord);if(e.pointNodeCoord.x===b.CHUNK_HALF_DIM){var a=e.chunkCoord.addX(1),r=i.chunks.get(a);if(r){var s=e.pointNodeCoord.withX(-b.CHUNK_HALF_DIM),c=r.pointNodes.get(s);c&&(n.right=new S({z:e.z,chunkCoord:a,pointNodeCoord:s,pointNodeId:c.id}))}}else{var u=e.pointNodeCoord.addX(1),d=o.pointNodes.get(u);d&&(n.right=new S({z:e.z,chunkCoord:e.chunkCoord,pointNodeCoord:u,pointNodeId:d.id}))}if(e.pointNodeCoord.x===-b.CHUNK_HALF_DIM){var l=e.chunkCoord.addX(-1),h=i.chunks.get(l);if(h){var p=e.pointNodeCoord.withX(b.CHUNK_HALF_DIM),v=h.pointNodes.get(p);v&&(n.left=new S({z:e.z,chunkCoord:l,pointNodeCoord:p,pointNodeId:v.id}))}}else{var f=e.pointNodeCoord.addX(-1),y=o.pointNodes.get(f);y&&(n.left=new S({z:e.z,chunkCoord:e.chunkCoord,pointNodeCoord:f,pointNodeId:y.id}))}if(e.pointNodeCoord.y===b.CHUNK_HALF_DIM){var j=e.chunkCoord.addY(1),k=i.chunks.get(j);if(k){var g=e.pointNodeCoord.withY(-b.CHUNK_HALF_DIM),O=k.pointNodes.get(g);O&&(n.down=new S({z:e.z,chunkCoord:j,pointNodeCoord:g,pointNodeId:O.id}))}}else{var x=e.pointNodeCoord.addY(1),w=o.pointNodes.get(x);w&&(n.down=new S({z:e.z,chunkCoord:e.chunkCoord,pointNodeCoord:x,pointNodeId:w.id}))}if(e.pointNodeCoord.y===-b.CHUNK_HALF_DIM){var m=e.chunkCoord.addY(-1),N=i.chunks.get(m);if(N){var C=e.pointNodeCoord.withY(b.CHUNK_HALF_DIM),I=N.pointNodes.get(C);I&&(n.up=new S({z:e.z,chunkCoord:m,pointNodeCoord:C,pointNodeId:I.id}))}}else{var z=e.pointNodeCoord.addY(-1),_=o.pointNodes.get(z);_&&(n.up=new S({z:e.z,chunkCoord:e.chunkCoord,pointNodeCoord:z,pointNodeId:_.id}))}return n}(e,t),o=[],a=Object(x.a)(_(C));try{for(a.s();!(n=a.n()).done;){var r=i[n.value];r&&o.push(r)}}catch(s){a.e(s)}finally{a.f()}return o}function T(e,t,n,i){if(n.contains(e))return"already allocated";if(i<1)return"not enough sp";var o,a=P(e,t),r=Object(x.a)(a);try{for(r.s();!(o=r.n()).done;){var s=o.value;if(n.contains(s))return"yes"}}catch(c){r.e(c)}finally{r.f()}return"not connected"}function M(e){var t=e.selectedPointNode,n=e.allocatedPointNodeSet,i=e.worldGen,a=e.availableSp;if(!t)return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("h1",{children:"Stats"}),Object(o.jsx)("div",{children:"Select a node first!"})]});var r=i.zLevels[t.z].chunks.get(t.chunkCoord).pointNodes.get(t.pointNodeCoord),s=n.contains(t),c=T(t,i,n,a),u="Nothing (empty node)";return r.resourceType!==k.Nothing&&(u="".concat(r.resourceAmount," ").concat(r.resourceModifier," ").concat(r.resourceType)),Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("h1",{children:"Stats"}),Object(o.jsxs)("div",{children:[" ",u," "]}),Object(o.jsx)("h3",{children:"Allocated?"}),s?"yes":"no",Object(o.jsx)("h3",{children:"Can be allocated?"}),c]})}!function(e){e.up="up",e.down="down",e.left="left",e.right="right"}(C||(C={}));n(132);var U=r.a.createContext([]);function A(e){var t=e.application,n=e.windowState,i=Object(a.useRef)(null),r=Object(a.useContext)(U),s=Object(u.a)(r,3),c=s[0],d=s[1],l=s[2];return Object(a.useEffect)((function(){for(var e=i.current.childNodes.length-1;e>=0;e--)i.current.removeChild(i.current.childNodes[e]);i.current.appendChild(t.app.view)}),[t]),t.rerender({args:{fireBatch:function(){l(),e.fireBatchedSetWindowState()},isSecondConstructorCall:!1},updaters:d,windowState:n,gameState:c}),Object(o.jsx)(o.Fragment,{children:Object(o.jsx)("div",{ref:i})})}var D=n(6),F=1e-7,G=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},n=arguments.length>1?arguments[1]:void 0;Object(y.a)(this,e),this._x=void 0,this._y=void 0,"number"===typeof t?(this._x=t,this._y=n):(this._x=t.x,this._y=t.y)}return Object(v.a)(e,[{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}}]),Object(v.a)(e,[{key:"hash",value:function(){return this.toString()}},{key:"toString",value:function(){return"[".concat(this.x,", ").concat(this.y,"]")}},{key:"invert",value:function(){return new e({x:-this.x,y:-this.y})}},{key:"round",value:function(){return new e({x:Math.round(this.x),y:Math.round(this.y)})}},{key:"floor",value:function(){return new e({x:Math.floor(this.x),y:Math.floor(this.y)})}},{key:"taxicabDistance",value:function(e){return Math.abs(e.x-this.x)+Math.abs(e.y-this.y)}},{key:"diagonalDistance",value:function(e){return Math.max(Math.abs(e.x-this.x),Math.abs(e.y-this.y))}},{key:"distance",value:function(e){var t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.sqrt(t*t+n*n)}},{key:"translate",value:function(t){return new e({x:this.x+t.x,y:this.y+t.y})}},{key:"subtract",value:function(t){return new e({x:this.x-t.x,y:this.y-t.y})}},{key:"add",value:function(t){return new e({x:this.x+t.x,y:this.y+t.y})}},{key:"addX",value:function(t){return new e({x:this.x+t,y:this.y})}},{key:"addY",value:function(t){return new e({x:this.x,y:this.y+t})}},{key:"subtractX",value:function(t){return new e({x:this.x-t,y:this.y})}},{key:"subtractY",value:function(t){return new e({x:this.x,y:this.y-t})}},{key:"clampY",value:function(t,n){var i=this.y;return i<t&&(i=t),i>n&&(i=n),new e({x:this.x,y:i})}},{key:"scale",value:function(t,n){return new e({x:(this.x-t.x)*n.x+t.x,y:(this.y-t.y)*n.y+t.y})}},{key:"rotate",value:function(t,n){return n/=180/Math.PI,new e({x:Math.cos(n)*(this.x-t.x)-Math.sin(n)*(this.y-t.y)+t.x,y:Math.sin(n)*(this.x-t.x)+Math.cos(n)*(this.y-t.y)+t.y})}},{key:"equals",value:function(e){return void 0!==e&&(Math.abs(this.x-e.x)<F&&Math.abs(this.y-e.y)<F)}},{key:"multiply",value:function(t){return new e("number"===typeof t?{x:this.x*t,y:this.y*t}:{x:this.x*t.x,y:this.y*t.y})}},{key:"divide",value:function(t){return new e("number"===typeof t?{x:this.x/t,y:this.y/t}:{x:this.x/t.x,y:this.y/t.y})}},{key:"toJSON",value:function(){return{__type:"Vector2",x:this.x,y:this.y}}},{key:"transform",value:function(t,n){return new e({x:Math.floor((this.x-t.x)*n),y:Math.floor((this.y-t.y)*n)})}},{key:"normalize",value:function(){if(0===this.x&&0===this.y)return this;var t=Math.sqrt(this.x*this.x+this.y*this.y);return new e({x:this.x/t,y:this.y/t})}},{key:"withX",value:function(t){return new e({x:t,y:this.y})}},{key:"withY",value:function(t){return new e({x:this.x,y:t})}},{key:"invertX",value:function(){return new e({x:-this.x,y:this.y})}},{key:"lerp",value:function(e,t){return(t>1||t<0)&&console.error("Lerp t must be between 0 and 1."),0===t?this:1===t?e:this.scale({x:0,y:0},{x:1-t,y:1-t}).add(e.scale({x:0,y:0},{x:t,y:t}))}},{key:"lerp2D",value:function(e,t,n){return(t>1||t<0||n>1||n<0)&&console.error("Lerp t must be between 0 and 1."),this.scale({x:0,y:0},{x:1-t,y:1-n}).add(e.scale({x:0,y:0},{x:t,y:n}))}},{key:"coserp",value:function(e,t){return t=.5*(1+Math.cos(2*t*Math.PI)),this.lerp(e,t)}},{key:"half",get:function(){return new e({x:this.x/2,y:this.y/2})}}],[{key:"IsVector2",value:function(t){return t instanceof e}},{key:"Random",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return new e({x:w.RandRange(i,t),y:w.RandRange(o,n)})}},{key:"Deserialize",value:function(t){return t.hasOwnProperty("x")&&t.hasOwnProperty("y")||console.error("Failed deserializing point"),new e({x:t.x,y:t.y})}},{key:"Serialize",value:function(e){return JSON.stringify({x:e.x,y:e.y})}}]),e}();G.Zero=new G(0,0),G.One=new G(1,1);n(124),n(123);var H=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(y.a)(this,e),this._values=void 0,this._values=new L;var n,i=Object(x.a)(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;this.put(o)}}catch(a){i.e(a)}finally{i.f()}}return Object(v.a)(e,[{key:"remove",value:function(e){this._values.remove(e)}},{key:"put",value:function(e){this._values.put(e,e)}},{key:"get",value:function(e){return void 0!==this._values.get(e)}},{key:"contains",value:function(e){return this._values.contains(e)}},{key:"values",value:function(){return this._values.values()}},{key:"clone",value:function(){var t=new e;return t._values=this._values.clone(),t}},{key:"size",value:function(){return this._values.size()}}]),e}(),L=function(){function e(){Object(y.a)(this,e),this._values={}}return Object(v.a)(e,[{key:"put",value:function(e,t){this._values[e.hash()]=t}},{key:"remove",value:function(e){delete this._values[e.hash()]}},{key:"get",value:function(e){return this._values[e.hash()]}},{key:"contains",value:function(e){return void 0!==this.get(e)&&e.hash()in this._values}},{key:"values",value:function(){return Object.values(this._values)}},{key:"size",value:function(){return Object.keys(this._values).length}},{key:"clone",value:function(){var t=new e;return t._values=Object(f.a)({},this._values),t}}]),e}(),R=function(){function e(){Object(y.a)(this,e),this._kvalues={}}return Object(v.a)(e,[{key:"put",value:function(e,t){this._kvalues[e.hash()]=[e,t]}},{key:"remove",value:function(e){delete this._kvalues[e.hash()]}},{key:"get",value:function(e){var t;return null===(t=this._kvalues[e.hash()])||void 0===t?void 0:t[1]}},{key:"contains",value:function(e){return void 0!==this.get(e)&&e.hash()in this._kvalues}},{key:"keys",value:function(){var e=this;return Object.keys(this._kvalues).map((function(t){return e._kvalues[t][0]}))}},{key:"entries",value:function(){var e=this;return Object.keys(this._kvalues).map((function(t){return e._kvalues[t]}))}},{key:"values",value:function(){var e=this;return Object.keys(this._kvalues).map((function(t){return e._kvalues[t][1]}))}},{key:"hashKeyset",value:function(){return Object.keys(this._kvalues).map((function(e){return E(e)})).reduce((function(e,t){return e+t})).toString()}},{key:"clone",value:function(){var t=new e;return t._kvalues=Object(f.a)({},this._kvalues),t}}]),e}();function E(e){for(var t=0,n=0;n<e.length;n++)t=Math.imul(31,t)+e.charCodeAt(n)|0;return t}function X(e){return new D.d(e.x,e.y)}var K=n(23);function q(e,t){return 0===e.availableSp&&e.activeQuest?Object(f.a)(Object(f.a)({},e),{},{availableSp:5,batchesSinceQuestStart:e.batchesSinceQuestStart+1}):e}function B(e){var t,n={},o=new L,a=Object(x.a)(e.playerSave.allocatedPointNodeHistory);try{for(a.s();!(t=a.n()).done;){var r=t.value,s=e.worldGen.zLevels[r.z].chunks.get(r.chunkCoord).pointNodes.get(r.pointNodeCoord);if("Nothing"!==s.resourceType){var c=new O({type:s.resourceType,modifier:s.resourceModifier});o.put(c,(o.get(c)||0)+s.resourceAmount)}}}catch(p){a.e(p)}finally{a.f()}var u,d=Object(x.a)(_(i));try{for(d.s();!(u=d.n()).done;){var l=u.value,h=o.get(new O({type:l,modifier:j.Flat}))||0;h*=1+.01*(o.get(new O({type:l,modifier:j.Increased0}))||0),h=Math.floor(h),h+=o.get(new O({type:l,modifier:j.AfterIncreased0}))||0,h*=1+.01*(o.get(new O({type:l,modifier:j.Increased1}))||0),h=Math.floor(h),h+=o.get(new O({type:l,modifier:j.AfterIncreased1}))||0,n[l]=h}}catch(p){d.e(p)}finally{d.f()}return{playerResourceAmounts:n,playerResourceNodesAggregated:o}}var Q=function(){function e(t){Object(y.a)(this,e),this.container=void 0,this.staleProps=void 0,this.state=void 0,this.sprite=void 0,this.centerSprite=void 0,this.staleProps=t,this.state={justTriedToAllocate:!1,justSpentSp:!1,justFailedToAllocate:!1,numClicks:0},this.container=new D.b,this.container.sortableChildren=!0,this.sprite=new D.g(t.args.pointNodeTexture),this.sprite.anchor.x=.5,this.sprite.anchor.y=.5,this.sprite.zIndex=-1,this.container.addChild(this.sprite),this.centerSprite=new D.g(t.args.pointNodeTexture),this.centerSprite.anchor.x=.5,this.centerSprite.anchor.y=.5,this.centerSprite.scale=X(new G(.5,.5)),this.centerSprite.zIndex=1,this.container.addChild(this.centerSprite),this.container.interactive=!0,this.container.buttonMode=!0,this.container.hitArea=new D.e(-Y.NODE_HITAREA_PX/2,-Y.NODE_HITAREA_PX/2,Y.NODE_HITAREA_PX,Y.NODE_HITAREA_PX),this.renderSelf(t),this.didMount()}return Object(v.a)(e,[{key:"renderSelf",value:function(e){var t,n;this.container.position=X(e.position),e.isSelected?(t=12303359,n=12303359):(t=16777215,n=16777215),e.isAllocated&&(t=4473924);var i=0;switch(e.pointNodeGen.resourceType){case k.Nothing:i=10075135;break;case k.Mana0:i=15641258;break;case k.Mana1:i=12285747;break;case k.Mana2:i=4500036}this.sprite.tint=z(i,t),this.centerSprite.tint=z(i,n)}},{key:"updateSelf",value:function(e){}},{key:"shouldUpdate",value:function(e,t){var n,i=Object(x.a)(Object.keys(e));try{for(i.s();!(n=i.n()).done;){var o=n.value;if("delta"!==o&&"args"!==o&&"updaters"!==o&&e[o]!==t[o])return!0}}catch(a){i.e(a)}finally{i.f()}return!1}},{key:"update",value:function(e){this.shouldUpdate(this.staleProps,e)&&(this.updateSelf(e),this.renderSelf(e),this.staleProps=e)}},{key:"didMount",value:function(){var e=this,t=this.staleProps,n=t.args,i=t.updaters;this.container.addListener("pointerdown",(function(t){e.state.numClicks++,i.playerUI.selectedPointNode.enqueueUpdate((function(t,i){return(null===t||void 0===t?void 0:t.pointNodeId)===n.selfPointNodeRef.pointNodeId&&(e.state.justTriedToAllocate=!0),n.selfPointNodeRef})),i.playerSave.enqueueUpdate((function(t,i){if(e.state.justTriedToAllocate){e.state.justTriedToAllocate=!1;var o=function(e,t,n){if("yes"===T(n,t.worldGen,t.playerSave.allocatedPointNodeSet,t.playerSave.availableSp)){var i=e.allocatedPointNodeSet.clone();i.put(n);var o=Object(K.a)(e.allocatedPointNodeHistory);o.push(n);var a=e.availableSp-1;return[Object(f.a)(Object(f.a)({},e),{},{allocatedPointNodeHistory:o,allocatedPointNodeSet:i,availableSp:a}),!0]}return[e,!1]}(t,i,n.selfPointNodeRef),a=Object(u.a)(o,2),r=a[0];return a[1]?(e.state.justSpentSp=!0,r):(e.state.justFailedToAllocate=!0,t)}return t})),i.enqueueUpdate((function(t,n){return e.state.justSpentSp?Object(f.a)(Object(f.a)({},t),{},{playerSave:q(t.playerSave),computed:Object(f.a)({},B(n))}):t})),i.playerUI.activeTab.enqueueUpdate((function(t,n){return e.state.justFailedToAllocate?(e.state.justFailedToAllocate=!1,1):t}))}))}}]),e}(),Y=function e(){Object(y.a)(this,e)};Y.SPACING_PX=24,Y.CHUNK_SPACING_PX=(b.CHUNK_DIM+.5)*Y.SPACING_PX,Y.NODE_SIZE_PX=14,Y.NODE_HITAREA_PX=18,Y.NODE_ROUNDED_PX=4;var Z=function(){function e(t){Object(y.a)(this,e),this.container=void 0,this.staleProps=void 0,this.state=void 0,this.children=void 0,this.staleProps=t,this.state={},this.container=new D.b,this.children=new R;var n,i=Object(x.a)(t.chunkGen.pointNodes.entries());try{for(i.s();!(n=i.n()).done;){var o,a=Object(u.a)(n.value,2),r=a[0],s=a[1],c=new S({z:t.args.selfChunkRef.z,chunkCoord:t.args.selfChunkRef.chunkCoord,pointNodeCoord:r,pointNodeId:s.id}),d={delta:t.delta,args:{pointNodeTexture:t.args.pointNodeTexture,selfPointNodeRef:c},updaters:t.updaters,pointNodeGen:s,position:c.pointNodeCoord.multiply(Y.SPACING_PX),isSelected:(null===(o=t.selectedPointNode)||void 0===o?void 0:o.pointNodeId)===c.pointNodeId,isAllocated:t.allocatedPointNodeSubset.contains(c)},l=new Q(d);this.children.put(c,l),this.container.addChild(l.container)}}catch(h){i.e(h)}finally{i.f()}this.renderSelf(t)}return Object(v.a)(e,[{key:"renderSelf",value:function(e){this.container.position=X(e.position)}},{key:"updateSelf",value:function(e){}},{key:"shouldUpdate",value:function(e,t){return!0}},{key:"update",value:function(e){if(this.shouldUpdate(this.staleProps,e)){this.updateSelf(e);var t,n=Object(x.a)(e.chunkGen.pointNodes.entries());try{for(n.s();!(t=n.n()).done;){var i,o=Object(u.a)(t.value,2),a=o[0],r=o[1],s=new S({z:e.args.selfChunkRef.z,chunkCoord:e.args.selfChunkRef.chunkCoord,pointNodeCoord:a,pointNodeId:r.id}),c={delta:e.delta,args:{pointNodeTexture:e.args.pointNodeTexture,selfPointNodeRef:s},updaters:e.updaters,position:s.pointNodeCoord.multiply(Y.SPACING_PX),pointNodeGen:r,isSelected:(null===(i=e.selectedPointNode)||void 0===i?void 0:i.pointNodeId)===s.pointNodeId,isAllocated:e.allocatedPointNodeSubset.contains(s)},d=this.children.get(s);d?d.update(c):(d=new Q(c),this.children.put(s,d),this.container.addChild(d.container))}}catch(l){n.e(l)}finally{n.f()}this.renderSelf(e),this.staleProps=e}}}]),e}();var W=n(8),J=function(){function e(t){Object(y.a)(this,e),this.config=void 0,this.chunkGenFactory=void 0,this.config=t,this.chunkGenFactory=new V({})}return Object(v.a)(e,[{key:"create",value:function(e){for(var t=Object(W.b)(e.seed+e.z),n=new R,i=e.startingChunks||3,o=-i;o<=i;o++)for(var a=-i;a<=i;a++){var r=new G(o,a);n.put(r,this.chunkGenFactory.create({seed:t,location:r,z:e.z}))}return{id:t,chunks:n}}}]),e}(),V=function(){function e(t){Object(y.a)(this,e),this.config=void 0,this.pointNodeGenFactory=void 0,this.config=t,this.pointNodeGenFactory=new $({})}return Object(v.a)(e,[{key:"create",value:function(e){for(var t=Object(W.b)(e.seed+Object(W.b)(e.seed+e.location.x)+e.location.y),n=new R,i=new H,o=-b.CHUNK_HALF_DIM;o<=b.CHUNK_HALF_DIM;o++)for(var a=-b.CHUNK_HALF_DIM;a<=b.CHUNK_HALF_DIM;a++)0===o&&0===a||Object(W.b)(t+o*b.CHUNK_DIM+a)/W.a<b.DROP_NODES_CHANCE/4&&(i.put(new G(o,a)),i.put(new G(a,-o)),i.put(new G(-o,-a)),i.put(new G(-a,o)));for(var r=-b.CHUNK_HALF_DIM;r<=b.CHUNK_HALF_DIM;r++)for(var s=-b.CHUNK_HALF_DIM;s<=b.CHUNK_HALF_DIM;s++){var c=new G(r,s);i.get(c)||n.put(c,this.pointNodeGenFactory.create({seed:t,location:c,chunk:e.location,z:e.z}))}return{id:t,pointNodes:n}}}]),e}(),$=function(){function e(t){Object(y.a)(this,e),this.config=void 0,this.config=t}return Object(v.a)(e,[{key:"create",value:function(e){var t,n,i=Object(W.b)(e.seed+Object(W.b)(e.seed+e.location.x)+e.location.y),o=Object(W.b)(i+1)/W.a;t=o<0?"Nothing":o<.2?k.Mana0:o<.35?k.Mana1:o<.6?k.Mana2:"Nothing",e.location.equals(G.Zero)&&e.chunk.equals(G.Zero)&&0===e.z&&(t="Nothing");var a=0;return(n=(o=Object(W.b)(i+2)/W.a)<.7?j.Flat:o<.73?j.AfterIncreased0:o<.75?j.AfterIncreased1:o<.95?j.Increased0:j.Increased1)===j.Flat||n===j.AfterIncreased0||n===j.AfterIncreased1?(o=Math.floor(Object(W.b)(i+3)/W.a*4),o+=Math.floor(Object(W.b)(i+4)/W.a*4),a=20*(o+=Math.floor(Object(W.b)(i+5)/W.a*4))+60):(o=Math.floor(Object(W.b)(i+3)/W.a*2),o+=Math.floor(Object(W.b)(i+4)/W.a*2),o+=Math.floor(Object(W.b)(i+5)/W.a*2),a=(o+=Math.floor(Object(W.b)(i+6)/W.a*3))+3),{id:i,resourceAmount:a,resourceModifier:n,resourceType:t}}}]),e}(),ee=function(){function e(){Object(y.a)(this,e),this.frameTimestampsInTicks=[],this.frameTimestampsInTime=[],this.frameTimestampsInTicks.push(0)}return Object(v.a)(e,[{key:"tick",value:function(e){var t=this.frameTimestampsInTicks[this.frameTimestampsInTicks.length-1];this.frameTimestampsInTicks.push(t+e),this.frameTimestampsInTicks.length>120&&(this.frameTimestampsInTicks=this.frameTimestampsInTicks.slice(60)),this.frameTimestampsInTime.push((new Date).getTime()),this.frameTimestampsInTime.length>120&&(this.frameTimestampsInTime=this.frameTimestampsInTime.slice(60))}},{key:"getUps",value:function(){var e=this.frameTimestampsInTicks[this.frameTimestampsInTicks.length-1]-this.frameTimestampsInTicks[0],t=(this.frameTimestampsInTicks.length-1)/e;return t?60*t:60}},{key:"getFps",value:function(){var e=this.frameTimestampsInTime[this.frameTimestampsInTime.length-1]-this.frameTimestampsInTime[0],t=(this.frameTimestampsInTime.length-1)/e;return t?1e3*t:60}},{key:"getFpsString",value:function(){return this.getFps().toFixed(1)}},{key:"getUpsString",value:function(){return this.getUps().toFixed(1)}}]),e}(),te=function(){function e(t){Object(y.a)(this,e),this.container=void 0,this.staleProps=void 0,this.state=void 0,this.container=new D.h("",{fontFamily:"PixelMix",fontSize:12}),this.state=new ee,this.staleProps=t,this.renderSelf(t)}return Object(v.a)(e,[{key:"update",value:function(e){this.updateSelf(e),this.renderSelf(e)}},{key:"updateSelf",value:function(e){this.state.tick(e.delta)}},{key:"renderSelf",value:function(e){this.container.text=this.state.getFpsString()+" FPS\n"+this.state.getUpsString()+" UPS\n"+e.appSize.x+"x"+e.appSize.y,this.container.position=X(e.position)}}]),e}(),ne=n(22);function ie(e,t){var n={getUpdater:function(){return t}};return n.enqueueUpdate=t,n.update=t,"object"!==typeof e||Object.keys(e).forEach((function(i){if("enqueueUpdate"===i||"getUpdater"===i||"update"===i)throw Error("Invalid key in updaterGenerator: ".concat(i," conflicts with reserved keywords enqueueUpdate, update, getUpdater."));n[i]=ie(e[i],(function(e){t("function"===typeof e?function(t,n){return Object(f.a)(Object(f.a)({},t),{},Object(ne.a)({},i,e(t[i],n)))}:function(t,n){return Object(f.a)(Object(f.a)({},t),{},Object(ne.a)({},i,e))})}))})),n}function oe(e,t){return ie(e,(function(e){t("function"===typeof e?function(t){return e(t,t)}:e)}))}var ae=function(){function e(t){var n,i,o=this;Object(y.a)(this,e),this.container=void 0,this.staleProps=void 0,this.state=void 0,this.children=new R,this.staleProps=t,this.state={},this.container=new D.b;var a,r=Object(x.a)((null===(n=t.zLevelGen)||void 0===n||null===(i=n.chunks)||void 0===i?void 0:i.entries())||[]);try{var s=function(){var e=Object(u.a)(a.value,2),n=e[0],i=e[1],r=new g({z:t.args.z,chunkCoord:n,chunkId:i.id}),s=new H(t.allocatedPointNodeSubset.values().filter((function(e){return e.chunkCoord.x===r.chunkCoord.x&&e.chunkCoord.y===r.chunkCoord.y}))),c={delta:t.delta,args:{pointNodeTexture:t.args.pointNodeTexture,selfChunkRef:r},updaters:t.updaters,position:r.chunkCoord.multiply(Y.CHUNK_SPACING_PX),chunkGen:i,selectedPointNode:t.selectedPointNode,allocatedPointNodeSubset:s},d=new Z(c);o.children.put(r,d),o.container.addChild(d.container)};for(r.s();!(a=r.n()).done;)s()}catch(c){r.e(c)}finally{r.f()}this.renderSelf(t),this.didMount()}return Object(v.a)(e,[{key:"renderSelf",value:function(e){this.container.position=X(e.position)}},{key:"updateSelf",value:function(e){}},{key:"shouldUpdate",value:function(e,t){var n,i=Object(x.a)(Object.keys(e));try{for(i.s();!(n=i.n()).done;){var o=n.value;if("delta"!==o&&"args"!==o&&"updaters"!==o){if("position"===o){if(e[o].equals(t[o]))continue;return!0}if(e[o]!==t[o])return!0}}}catch(a){i.e(a)}finally{i.f()}return!1}},{key:"update",value:function(e){var t,n,i=this;if(this.shouldUpdate(this.staleProps,e)){this.updateSelf(e);var o,a=Object(x.a)((null===(t=e.zLevelGen)||void 0===t||null===(n=t.chunks)||void 0===n?void 0:n.entries())||[]);try{var r=function(){var t=Object(u.a)(o.value,2),n=t[0],a=t[1],r=new g({z:e.args.z,chunkCoord:n,chunkId:a.id}),s=new H(e.allocatedPointNodeSubset.values().filter((function(e){return e.chunkCoord.x===r.chunkCoord.x&&e.chunkCoord.y===r.chunkCoord.y}))),c={delta:e.delta,args:{pointNodeTexture:e.args.pointNodeTexture,selfChunkRef:r},updaters:e.updaters,position:r.chunkCoord.multiply(Y.CHUNK_SPACING_PX),chunkGen:a,selectedPointNode:e.selectedPointNode,allocatedPointNodeSubset:s},d=i.children.get(r);d?d.update(c):(d=new Z(c),i.children.put(r,d),i.container.addChild(d.container))};for(a.s();!(o=a.n()).done;)r()}catch(s){a.e(s)}finally{a.f()}this.renderSelf(e),this.didUpdate(this.staleProps,e),this.staleProps=e}}},{key:"didUpdate",value:function(e,t){}},{key:"didMount",value:function(){var e=this.staleProps,t=e.args;e.updaters.worldGen.zLevels.update((function(e,n){return e[t.z]?e:Object(ne.a)({},t.z,new J({}).create({seed:n.worldGen.seed,z:t.z}))}))}}]),e}(),re=function(){function e(t){Object(y.a)(this,e),this.container=void 0,this.staleProps=void 0,this.state=void 0,this.container=new D.c,this.staleProps=t,this.state={position:t.appSize.multiply(.5)},this.container.lineStyle(2,10066329),this.container.drawCircle(0,0,10),this.container.interactive=!0,this.container.buttonMode=!0,this.renderSelf(t)}return Object(v.a)(e,[{key:"update",value:function(e){this.updateSelf(e),this.renderSelf(e),this.staleProps=e}},{key:"updateSelf",value:function(e){this.state.position=e.appSize.multiply(.5)}},{key:"renderSelf",value:function(e){this.container.position=X(this.state.position)}}]),e}();function se(e){var t=[];return[function(e){t.push(e),console.log({batchSize:t.length})},function(){if(0!==t.length){console.log({fired:t.length});var n=Object(K.a)(t);t=[],e((function(e){var t,i=e,o=Object(x.a)(n);try{for(o.s();!(t=o.n()).done;){var a=t.value;i="function"===typeof a?a(i):a}}catch(r){o.e(r)}finally{o.f()}return i}))}}]}var ce=function(){function e(t){var n=this;Object(y.a)(this,e),this.container=void 0,this.staleProps=void 0,this.state=void 0,this.stateUpdaters=void 0,this.fireStateUpdaters=void 0,this.fixedCameraStage=void 0,this.actionStage=void 0,this.backdropStage=void 0,this.keyboard=void 0,this.fpsTracker=void 0,this.zLevel=void 0,this.reticle=void 0,this.backdrop=void 0,this.container=new D.b,this.container.sortableChildren=!0,this.staleProps=t,this.state={pointNodeTexture:new I((function(){return function(e){var t=new D.c;return t.beginFill(16777215),t.drawRoundedRect(-Y.NODE_SIZE_PX/2,-Y.NODE_SIZE_PX/2,Y.NODE_SIZE_PX,Y.NODE_SIZE_PX,Y.NODE_ROUNDED_PX),e.generateTexture(t,D.f.NEAREST,1)}(t.args.renderer)})),tick:0,playerIntents:{decreaseZLevel:{justDown:!1,justUp:!1,down:!1},increaseZLevel:{justDown:!1,justUp:!1,down:!1},panLeft:{justDown:!1,justUp:!1,down:!1},panRight:{justDown:!1,justUp:!1,down:!1},panUp:{justDown:!1,justUp:!1,down:!1},panDown:{justDown:!1,justUp:!1,down:!1}}};var i=se((function(e){n.state="function"===typeof e?e(n.state):e})),o=Object(u.a)(i,2),a=o[0],r=o[1];this.stateUpdaters=oe(this.state,a),this.fireStateUpdaters=r,this.fixedCameraStage=new D.g,this.fixedCameraStage.zIndex=1,this.fixedCameraStage.sortableChildren=!0,this.container.addChild(this.fixedCameraStage),this.actionStage=new D.g,this.actionStage.zIndex=0,this.actionStage.sortableChildren=!0,this.container.addChild(this.actionStage),this.backdropStage=new D.g,this.backdropStage.zIndex=-1,this.backdropStage.sortableChildren=!0,this.container.addChild(this.backdropStage),this.fpsTracker=new te({delta:t.delta,position:new G(0,0),appSize:t.appSize}),this.fixedCameraStage.addChild(this.fpsTracker.container),this.backdrop=new D.c,this.backdropStage.addChild(this.backdrop),this.backdrop.beginFill(11259375,1),this.backdrop.interactive=!0,this.backdrop.drawRect(0,0,t.appSize.x,t.appSize.y),this.reticle=new re({appSize:t.appSize}),this.fixedCameraStage.addChild(this.reticle.container);var s={delta:0,args:{pointNodeTexture:this.state.pointNodeTexture.get(),z:0},updaters:t.updaters,position:t.appSize.multiply(.5),zLevelGen:t.gameState.worldGen.zLevels[0],selectedPointNode:t.gameState.playerUI.selectedPointNode,allocatedPointNodeSubset:t.gameState.playerSave.allocatedPointNodeSet};this.zLevel?this.zLevel.update(s):(this.zLevel=new ae(s),this.actionStage.addChild(this.zLevel.container)),this.renderSelf(t),this.didMount()}return Object(v.a)(e,[{key:"shouldUpdate",value:function(e,t){var n=e.gameState.playerSave.allocatedPointNodeSet.size(),i=t.gameState.playerSave.allocatedPointNodeSet.size();return n!==i&&console.log("rootapp shouldUpdate",{prevSize:n,nextSize:i}),!0}},{key:"update",value:function(e){if(this.shouldUpdate(this.staleProps,e)){this.updateSelf(e),this.fpsTracker.update({delta:e.delta,position:new G(0,0),appSize:e.appSize});var t={delta:0,args:{pointNodeTexture:this.state.pointNodeTexture.get(),z:0},updaters:e.updaters,position:e.appSize.multiply(.5),zLevelGen:e.gameState.worldGen.zLevels[0],selectedPointNode:e.gameState.playerUI.selectedPointNode,allocatedPointNodeSubset:e.gameState.playerSave.allocatedPointNodeSet};this.zLevel?this.zLevel.update(t):(this.zLevel=new ae(t),this.actionStage.addChild(this.zLevel.container)),this.reticle.update({appSize:e.appSize}),this.renderSelf(e),this.didUpdate(this.staleProps,e),this.staleProps=e,this.fireStateUpdaters()}}},{key:"updateSelf",value:function(e){this.state.tick++}},{key:"renderSelf",value:function(e){this.backdrop.width=e.appSize.x,this.backdrop.height=e.appSize.y}},{key:"didMount",value:function(){var e=this.staleProps.updaters;this.backdrop.addListener("pointerdown",(function(t){e.playerUI.selectedPointNode.enqueueUpdate((function(e,t){}))}))}},{key:"willUnmount",value:function(e){}},{key:"didUpdate",value:function(e,t){var n=this.staleProps.updaters;this.state.tick>60&&!t.gameState.worldGen.zLevels[-1]&&n.worldGen.zLevels.update((function(e,t){return e[-1]?e:(e[-1]=new J({}).create({seed:t.worldGen.seed,z:0}),Object(f.a)({},e))})),this.state.tick>120&&!t.gameState.worldGen.zLevels[1]&&n.worldGen.zLevels.update((function(e,t){return e[1]?e:(e[1]=new J({}).create({seed:t.worldGen.seed,z:1}),Object(f.a)({},e))}))}}]),e}();var ue=function(){function e(t){var n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(y.a)(this,e),this.app=void 0,this.state=void 0,this.props=void 0,this.RootComponent=void 0,this.onTick=void 0,(null===t||void 0===t||null===(n=t.args)||void 0===n?void 0:n.isSecondConstructorCall)||i||N("Base application constructor");var o=new G(800,600);this.state={appSize:o,originalAppSize:o},this.app=new D.a({width:this.state.appSize.x,height:this.state.appSize.y,antialias:!0,transparent:!0,resolution:window.devicePixelRatio||1,autoDensity:!0,powerPreference:"low-power",backgroundColor:16777215})}return Object(v.a)(e,[{key:"pause",value:function(){this.app.ticker.remove(this.onTick)}},{key:"destroy",value:function(){this.app.destroy(!0,{children:!0,texture:!0,baseTexture:!0})}},{key:"didMount",value:function(){var e=this;this.onTick=function(t){return e.baseGameLoop(t)},this.onTick=this.onTick.bind(this),this.app.ticker.add(this.onTick)}},{key:"register",value:function(e){e.appendChild(this.app.view)}},{key:"update",value:function(e){this.props=e}},{key:"updateSelf",value:function(e){this.state.appSize=function(e){return new G({x:Math.min(1920,((null===e||void 0===e?void 0:e.x)||1/0)-24),y:Math.min(1080,((null===e||void 0===e?void 0:e.y)||1/0)-24)})}(new G(e.windowState.innerWidth,e.windowState.innerHeight))}},{key:"rerender",value:function(e){console.log("base app rerender called",{playerUI:e.gameState.playerUI}),this.props=e,this.RootComponent||(this.RootComponent=new ce({args:{renderer:this.app.renderer},updaters:this.props.updaters,delta:0,gameState:this.props.gameState,appSize:this.state.appSize}),this.app.stage.addChild(this.RootComponent.container),this.renderSelf(this.props),this.didMount())}},{key:"renderSelf",value:function(e){this.app.renderer.resize(this.state.appSize.x,this.state.appSize.y)}},{key:"didUpdate",value:function(e){}},{key:"baseGameLoop",value:function(e){var t;this.updateSelf(this.props),null===(t=this.RootComponent)||void 0===t||t.update({args:{renderer:this.app.renderer},updaters:this.props.updaters,delta:e,gameState:this.props.gameState,appSize:this.state.appSize}),this.renderSelf(this.props),this.didUpdate(this.props),this.props.args.fireBatch()}}]),e}(),de=function(){function e(t){Object(y.a)(this,e),this.config=void 0,this.config=t}return Object(v.a)(e,[{key:"create",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;void 0===n&&N("GameStateFactory.create");var i=n||103043,o=new J({}).create({seed:i,z:0,startingChunks:0}),a=new G(0,0),r=null===(e=o.chunks.get(a))||void 0===e||null===(t=e.pointNodes.get(a))||void 0===t?void 0:t.id,s=new S({z:0,chunkCoord:a,pointNodeId:r,pointNodeCoord:a}),c={worldGen:{seed:i,zLevels:{0:o}},playerSave:{availableSp:0,activeQuest:void 0,batchesSinceQuestStart:0,allocatedPointNodeSet:new H([s]),allocatedPointNodeHistory:[s]},playerUI:{selectedPointNode:void 0,activeTab:0},computed:{}};return c.computed=Object(f.a)({},B(c)),c}}]),e}(),le=new I((function(){return new ue}));function he(e){var t=Object(a.useContext)(U),n=Object(u.a)(t,2),i=(n[0],n[1]),r=Object(a.useState)({orientation:"original",innerHeight:window.innerHeight,innerWidth:window.innerWidth}),s=Object(u.a)(r,2),c=s[0],d=s[1],l=Object(a.useMemo)((function(){return se(d)}),[d]),h=Object(u.a)(l,2),p=h[0],v=h[1],y=Object(a.useState)(le.get()),b=Object(u.a)(y,2),j=b[0],k=b[1];return window.onresize=function(){p((function(e){return e.innerWidth=window.innerWidth,e.innerHeight=window.innerHeight,Object(f.a)({},e)}))},Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(A,{application:j,windowState:c,fireBatchedSetWindowState:v}),Object(o.jsx)("button",{onClick:function(){i.update((function(e){var t=new de({}).create(e.worldGen.seed);return e.playerSave=t.playerSave,e.playerUI=t.playerUI,e.worldGen=t.worldGen,e}))},children:"Reset game state"}),Object(o.jsx)("button",{onClick:function(){j.pause(),j.destroy(),k(new ue(void 0,!0));var t=new de({}).create(+new Date);e.originalSetGameState((function(e){return e.playerSave=t.playerSave,e.playerUI=t.playerUI,e.worldGen=t.worldGen,e}))},children:"Get a fresh seed, reset, and rerender"}),Object(o.jsx)("button",{onClick:function(){j.pause(),j.destroy(),k(new ue(void 0,!0))},children:"Rerender pixi application"})]})}n(229);function pe(e){var t=e.activeQuest,n=e.remainingPoints,i=e.createQuestCb,a=e.numBatches,r=e.playerResourceAmounts,s=t&&((null===r||void 0===r?void 0:r[t.resourceType])||0)>=t.resourceAmount;return Object(o.jsxs)(o.Fragment,{children:[void 0===t?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)("h2",{children:[" You have no ",Object(o.jsx)("br",{}),"active quests! "]}),Object(o.jsx)("br",{}),Object(o.jsx)("br",{}),Object(o.jsx)("button",{className:"button",onClick:function(){i()},children:"Get a quest"}),Object(o.jsx)("br",{}),Object(o.jsx)("br",{}),Object(o.jsx)("br",{})]}):Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("h2",{children:" Active quest: "}),Object(o.jsx)("h3",{children:"Goal:"}),Object(o.jsxs)("div",{children:[t.resourceAmount," ",t.resourceType]}),Object(o.jsx)("br",{}),Object(o.jsx)("h3",{children:"Current:"}),Object(o.jsxs)("div",{className:l()({good:s}),children:[null===r||void 0===r?void 0:r[t.resourceType]," ",t.resourceType]}),Object(o.jsx)("br",{}),Object(o.jsx)("h3",{children:"Efficiency:"}),Object(o.jsx)("div",{children:"SS"}),s?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("br",{}),Object(o.jsx)("button",{className:"button",onClick:function(){window.alert("your score increased by 831!")},children:"Claim reward"})]}):Object(o.jsx)(o.Fragment,{}),Object(o.jsx)("h3",{children:"Batches so far: "}),Object(o.jsx)("div",{children:a}),Object(o.jsx)("br",{}),Object(o.jsxs)("div",{children:["(Hint: You won't run ",Object(o.jsx)("br",{}),"out of skill points, but",Object(o.jsx)("br",{})," they come in batches -",Object(o.jsx)("br",{}),"try to use the ",Object(o.jsx)("br",{})," fewest you can!)"]})]}),Object(o.jsx)("br",{}),Object(o.jsx)("h3",{children:" Available SP: "}),Object(o.jsx)("div",{children:n}),0===n?Object(o.jsxs)("div",{children:[Object(o.jsx)("br",{}),"(Start a quest first!)"]}):Object(o.jsx)(o.Fragment,{})]})}n(230);function ve(e){var t=e.children;return Object(o.jsx)("div",{className:"layout",children:t})}function fe(e){var t=e.showContent,n=e.children;return Object(o.jsx)("div",{hidden:!t,children:n})}n(231);function ye(e){var t=e.value,n=e.labels,i=e.onChange;return Object(o.jsx)("div",{className:"tab-label-container",children:n.map((function(e,n){return Object(o.jsx)(be,{onClick:i,value:n,active:t===n,children:e},n)}))})}function be(e){var t=e.onClick,n=e.value,i=e.active,a=e.children;return Object(o.jsx)("div",{className:i?"tab-label active":"tab-label inactive",children:Object(o.jsx)("div",{onClick:function(){t(n)},children:a})})}function je(e){var t=e.selectedPointNode,n=e.allocatedPointNodeSet,i=e.worldGen,r=e.availableSp,s=e.computed,c=Object(a.useState)([]),d=Object(u.a)(c,2),l=d[0],h=d[1];if(Object(a.useEffect)((function(){t&&h((function(e){return[].concat(Object(K.a)(e),[t])}))}),[t]),!t)return Object(o.jsx)(o.Fragment,{children:" "});var p=i.zLevels[t.z].chunks.get(t.chunkCoord).pointNodes.get(t.pointNodeCoord),v=n.contains(t),f=T(t,i,n,r),y="Nothing (empty node)";return p.resourceType!==k.Nothing&&(y="".concat(p.resourceAmount," ").concat(p.resourceModifier," ").concat(p.resourceType)),Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("h3",{children:"Player resources"}),JSON.stringify(s.playerResourceAmounts),Object(o.jsx)("h3",{children:"Current Node"}),Object(o.jsxs)("div",{children:["Z=",t.z]}),Object(o.jsxs)("div",{children:["Chunk=",t.chunkCoord.x,",",t.chunkCoord.y]}),Object(o.jsxs)("div",{children:["Node=",t.pointNodeCoord.x,",",t.pointNodeCoord.y]}),Object(o.jsx)("br",{}),Object(o.jsxs)("div",{children:["Allocated? ",Object(o.jsx)("br",{}),v?"yes":"no"," "]}),Object(o.jsx)("br",{}),Object(o.jsxs)("div",{children:["Can be allocated? ",Object(o.jsx)("br",{}),f," "]}),Object(o.jsx)("br",{}),Object(o.jsx)("div",{children:" Stats: "}),Object(o.jsxs)("div",{children:[" ",y," "]}),Object(o.jsx)("h3",{children:"Previous"}),l.slice(0,-1).map((function(e,t){return Object(o.jsx)("div",{children:Object(o.jsxs)("div",{children:["Z=",e.z," ","Chunk=",e.chunkCoord.x,",",e.chunkCoord.y," ","Node=",e.pointNodeCoord.x,",",e.pointNodeCoord.y]})},t)})).reverse()]})}var ke=function(){function e(t){Object(y.a)(this,e),this.config=void 0,this.config=t}return Object(v.a)(e,[{key:"create",value:function(){return{description:"",resourceType:k.Mana0,resourceAmount:3e3}}}]),e}(),Se=(new p.a).getBrowser(),ge=!1;"Mobile Safari"===Se.name&&window.innerWidth<window.innerHeight&&(ge=!0);var Oe=["Quest Progress","Node Details","Debug"],xe=new I((function(){return new de({}).create()}));var we=function(){var e=Object(a.useState)((function(){return xe.get()})),t=Object(u.a)(e,2),n=t[0],i=t[1],r=Object(a.useMemo)((function(){return se(i)}),[i]),s=Object(u.a)(r,2),c=s[0],d=s[1],h=Object(a.useMemo)((function(){return oe(xe.get(),c)}),[c]),p=[];p[1]=Object(a.useMemo)((function(){return Object(o.jsx)(M,{selectedPointNode:n.playerUI.selectedPointNode,allocatedPointNodeSet:n.playerSave.allocatedPointNodeSet,worldGen:n.worldGen,availableSp:n.playerSave.availableSp})}),[n.playerUI.selectedPointNode,n.playerSave.allocatedPointNodeSet,n.worldGen,n.playerSave.availableSp]);var v=Object(a.useCallback)((function(){return function(e){e.playerSave.activeQuest.enqueueUpdate((function(e){return new ke({}).create()})),e.playerSave.batchesSinceQuestStart.enqueueUpdate((function(e){return 1})),e.playerSave.availableSp.enqueueUpdate((function(e){return 5}))}(h)}),[h]);return p[0]=Object(a.useMemo)((function(){return Object(o.jsx)(pe,{remainingPoints:n.playerSave.availableSp,createQuestCb:v,activeQuest:n.playerSave.activeQuest,numBatches:n.playerSave.batchesSinceQuestStart,playerResourceAmounts:n.computed.playerResourceAmounts})}),[n.playerSave.availableSp,n.playerSave.activeQuest,v,n.playerSave.batchesSinceQuestStart,n.computed.playerResourceAmounts]),p[2]=Object(a.useMemo)((function(){return Object(o.jsx)(je,{selectedPointNode:n.playerUI.selectedPointNode,allocatedPointNodeSet:n.playerSave.allocatedPointNodeSet,worldGen:n.worldGen,availableSp:n.playerSave.availableSp,computed:n.computed})}),[n.playerUI.selectedPointNode,n.playerSave.allocatedPointNodeSet,n.worldGen,n.playerSave.availableSp,n.computed]),Object(o.jsx)("div",{className:l()({App:!0,"force-landscape":ge}),children:Object(o.jsxs)(U.Provider,{value:[n,h,d],children:[Object(o.jsx)(he,{originalSetGameState:i}),Object(o.jsxs)(ve,{children:[Object(o.jsx)(ye,{value:n.playerUI.activeTab,labels:Oe,onChange:h.playerUI.activeTab.getUpdater()}),p.map((function(e,t){return Object(o.jsx)(fe,{showContent:n.playerUI.activeTab===t,children:e},t)}))]})]})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(Object(o.jsx)(r.a.StrictMode,{children:Object(o.jsx)(we,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));n(2),n(3),n(45);var i=Math.pow(2,32);function o(e){var t=(e+i)%i;return t=Math.imul(t,3039394381),t^=t>>>8,t+=1759714724,t^=t<<8,t=Math.imul(t,458671337),((t^=t>>>8)+i)%i}}).call(this,n(11).Buffer)}},[[232,1,2]]]);
//# sourceMappingURL=main.54d0b7f5.chunk.js.map