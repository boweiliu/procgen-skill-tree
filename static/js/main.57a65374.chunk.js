(this["webpackJsonpprocgen-skill-tree"]=this["webpackJsonpprocgen-skill-tree"]||[]).push([[0],{124:function(e,t,n){},132:function(e,t,n){},133:function(e,t,n){},134:function(e,t,n){},144:function(e,t){},146:function(e,t){},157:function(e,t){},159:function(e,t){},184:function(e,t){},186:function(e,t){},187:function(e,t){},192:function(e,t){},194:function(e,t){},213:function(e,t){},225:function(e,t){},228:function(e,t){},231:function(e,t,n){},232:function(e,t,n){},233:function(e,t,n){},234:function(e,t,n){},235:function(e,t,n){},236:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(1),r=n.n(i),o=n(125),c=n.n(o),u=(n(132),n(7)),s=(n(133),n(31)),d=n.n(s),l=(n(134),n(2)),h=n(3),f=function(){function e(){Object(l.a)(this,e),this.frameTimestampsInTicks=[],this.frameTimestampsInTime=[],this.frameTimestampsInTicks.push(0)}return Object(h.a)(e,[{key:"tick",value:function(e){var t=this.frameTimestampsInTicks[this.frameTimestampsInTicks.length-1];this.frameTimestampsInTicks.push(t+e),this.frameTimestampsInTicks.length>120&&(this.frameTimestampsInTicks=this.frameTimestampsInTicks.slice(60)),this.frameTimestampsInTime.push((new Date).getTime()),this.frameTimestampsInTime.length>120&&(this.frameTimestampsInTime=this.frameTimestampsInTime.slice(60))}},{key:"getUps",value:function(){var e=this.frameTimestampsInTicks[this.frameTimestampsInTicks.length-1]-this.frameTimestampsInTicks[0],t=(this.frameTimestampsInTicks.length-1)/e;return t?60*t:60}},{key:"getFps",value:function(){var e=this.frameTimestampsInTime[this.frameTimestampsInTime.length-1]-this.frameTimestampsInTime[0],t=(this.frameTimestampsInTime.length-1)/e;return t?1e3*t:60}},{key:"getFpsString",value:function(){return this.getFps().toFixed(1)}},{key:"getUpsString",value:function(){return this.getUps().toFixed(1)}}]),e}();function p(e){var t=Object(i.useRef)(new f);return Object(i.useEffect)((function(){t.current.tick(0)}),[e.tick]),Object(a.jsxs)("div",{className:"text",children:[Object(a.jsxs)("div",{children:[e.windowState.innerWidth,"x",e.windowState.innerHeight]}),Object(a.jsx)(v,{}),Object(a.jsxs)("div",{children:["UPS: ",t.current.getFpsString()]})]})}function v(){var e=Object(i.useState)(0),t=Object(u.a)(e,2),n=t[0],r=t[1],o=Object(i.useRef)(new f);Object(i.useEffect)((function(){var e=setTimeout((function(){r((function(e){return e+1})),o.current.tick(0)}),5);return function(){return clearTimeout(e)}}),[n]);var c=Object(i.useMemo)((function(){return n>=0?o.current.getFpsString():""}),[n]);return Object(a.jsxs)("div",{children:["RPS: ",c]})}var b=n(13),y=n(12),O=1e-7,g=n(10),S=function(){function e(){Object(l.a)(this,e)}return Object(h.a)(e,null,[{key:"MinBy",value:function(e,t){var n,a=null,i=null,r=Object(g.a)(e);try{for(r.s();!(n=r.n()).done;){var o=n.value,c=t(o);(null===i||c<i)&&(a=o,i=c)}}catch(u){r.e(u)}finally{r.f()}return a}},{key:"MinByAndValue",value:function(e,t){var n,a=null,i=null,r=Object(g.a)(e);try{for(r.s();!(n=r.n()).done;){var o=n.value,c=t(o);(null===i||c<i)&&(a=o,i=c)}}catch(u){r.e(u)}finally{r.f()}return null===a||null===i?null:{obj:a,value:i}}},{key:"MaxBy",value:function(e,t){var n,a=null,i=null,r=Object(g.a)(e);try{for(r.s();!(n=r.n()).done;){var o=n.value,c=t(o);(null===i||c>i)&&(a=o,i=c)}}catch(u){r.e(u)}finally{r.f()}return a}},{key:"RandRange",value:function(e,t){return Math.floor(Math.random()*(t-e)+e)}},{key:"SortByKey",value:function(e,t){return e.sort((function(e,n){return t(e)-t(n)}))}},{key:"ReplaceAll",value:function(e,t){var n=new RegExp(Object.keys(t).join("|"),"gi");return e.replace(n,(function(e){return t[e.toLowerCase()]}))}},{key:"Debounce",value:function(e){var t,n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{isImmediate:!1},r=function(){for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];var u=function(){t=void 0,i.isImmediate||e.apply(n,o)},s=i.isImmediate&&void 0===t;void 0!==t&&clearTimeout(t),t=setTimeout(u,a),s&&e.apply(n,o)};return r}},{key:"FormatDate",value:function(e){var t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()];return"".concat(t," ").concat(e.getDate(),", ").concat(("00"+e.getHours()).substr(-2),":").concat(("00"+e.getMinutes()).substr(-2),":").concat(("00"+e.getSeconds()).substr(-2))}},{key:"FlattenByOne",value:function(e){var t,n=[],a=Object(g.a)(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;n=n.concat(i)}}catch(r){a.e(r)}finally{a.f()}return n}},{key:"PadString",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:" ";return e+n+a.repeat(t-e.length)}}]),e}();function j(e,t){var n=[16711680&e,16711680&t],a=[255&e,255&t],i=[65280&e,65280&t],r=65536*Math.round(n[0]/65536*n[1]/16777215);return r+=256*Math.round(i[0]/256*i[1]/65280),r+=Math.round(a[0]*a[1]/255)}function m(e){return Object.keys(e)}var x=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},n=arguments.length>1?arguments[1]:void 0;Object(l.a)(this,e),this._x=void 0,this._y=void 0,"number"===typeof t?(this._x=t,this._y=n):(this._x=t.x,this._y=t.y)}return Object(h.a)(e,[{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}}]),Object(h.a)(e,[{key:"hash",value:function(){return this.toString()}},{key:"toString",value:function(){return"[".concat(this.x,", ").concat(this.y,"]")}},{key:"invert",value:function(){return new e({x:-this.x,y:-this.y})}},{key:"round",value:function(){return new e({x:Math.round(this.x),y:Math.round(this.y)})}},{key:"floor",value:function(){return new e({x:Math.floor(this.x),y:Math.floor(this.y)})}},{key:"taxicabDistance",value:function(e){return Math.abs(e.x-this.x)+Math.abs(e.y-this.y)}},{key:"diagonalDistance",value:function(e){return Math.max(Math.abs(e.x-this.x),Math.abs(e.y-this.y))}},{key:"distance",value:function(e){var t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.sqrt(t*t+n*n)}},{key:"translate",value:function(t){return new e({x:this.x+t.x,y:this.y+t.y})}},{key:"subtract",value:function(t){return new e({x:this.x-t.x,y:this.y-t.y})}},{key:"add",value:function(t){return new e({x:this.x+t.x,y:this.y+t.y})}},{key:"addX",value:function(t){return new e({x:this.x+t,y:this.y})}},{key:"addY",value:function(t){return new e({x:this.x,y:this.y+t})}},{key:"subtractX",value:function(t){return new e({x:this.x-t,y:this.y})}},{key:"subtractY",value:function(t){return new e({x:this.x,y:this.y-t})}},{key:"clampX",value:function(t,n){var a=this.x;return a<t&&(a=t),a>n&&(a=n),new e({x:a,y:this.y})}},{key:"clampY",value:function(t,n){var a=this.y;return a<t&&(a=t),a>n&&(a=n),new e({x:this.x,y:a})}},{key:"scale",value:function(t,n){return new e({x:(this.x-t.x)*n.x+t.x,y:(this.y-t.y)*n.y+t.y})}},{key:"rotate",value:function(t,n){return n/=180/Math.PI,new e({x:Math.cos(n)*(this.x-t.x)-Math.sin(n)*(this.y-t.y)+t.x,y:Math.sin(n)*(this.x-t.x)+Math.cos(n)*(this.y-t.y)+t.y})}},{key:"equals",value:function(e){return void 0!==e&&(Math.abs(this.x-e.x)<O&&Math.abs(this.y-e.y)<O)}},{key:"multiply",value:function(t){return new e("number"===typeof t?{x:this.x*t,y:this.y*t}:{x:this.x*t.x,y:this.y*t.y})}},{key:"divide",value:function(t){return new e("number"===typeof t?{x:this.x/t,y:this.y/t}:{x:this.x/t.x,y:this.y/t.y})}},{key:"toJSON",value:function(){return{__type:"Vector2",x:this.x,y:this.y}}},{key:"transform",value:function(t,n){return new e({x:Math.floor((this.x-t.x)*n),y:Math.floor((this.y-t.y)*n)})}},{key:"normalize",value:function(){if(0===this.x&&0===this.y)return this;var t=Math.sqrt(this.x*this.x+this.y*this.y);return new e({x:this.x/t,y:this.y/t})}},{key:"withX",value:function(t){return new e({x:t,y:this.y})}},{key:"withY",value:function(t){return new e({x:this.x,y:t})}},{key:"invertX",value:function(){return new e({x:-this.x,y:this.y})}},{key:"lerp",value:function(e,t){return(t>1||t<0)&&console.error("Lerp t must be between 0 and 1."),0===t?this:1===t?e:this.scale({x:0,y:0},{x:1-t,y:1-t}).add(e.scale({x:0,y:0},{x:t,y:t}))}},{key:"lerp2D",value:function(e,t,n){return(t>1||t<0||n>1||n<0)&&console.error("Lerp t must be between 0 and 1."),this.scale({x:0,y:0},{x:1-t,y:1-n}).add(e.scale({x:0,y:0},{x:t,y:n}))}},{key:"coserp",value:function(e,t){return t=.5*(1+Math.cos(2*t*Math.PI)),this.lerp(e,t)}},{key:"half",get:function(){return new e({x:this.x/2,y:this.y/2})}}],[{key:"IsVector2",value:function(t){return t instanceof e}},{key:"Random",value:function(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return new e({x:S.RandRange(a,t),y:S.RandRange(i,n)})}},{key:"Deserialize",value:function(t){return t.hasOwnProperty("x")&&t.hasOwnProperty("y")||console.error("Failed deserializing point"),new e({x:t.x,y:t.y})}},{key:"Serialize",value:function(e){return JSON.stringify({x:e.x,y:e.y})}}]),e}();x.Zero=new x(0,0),x.One=new x(1,1);var k,w,E,T,N=function(){function e(t){Object(l.a)(this,e),this.z=void 0,this.chunkCoord=void 0,this.pointNodeCoord=void 0,this.pointNodeId=void 0,this.z=t.z,this.chunkCoord=t.chunkCoord,this.pointNodeCoord=t.pointNodeCoord,this.pointNodeId=t.pointNodeId}return Object(h.a)(e,[{key:"hash",value:function(){return this.pointNodeId.toString()+this.z.toString()+this.chunkCoord.toString()+this.pointNodeCoord.toString()}},{key:"toString",value:function(){return this.z+","+this.chunkCoord.toString()+","+this.pointNodeCoord.toString()}}]),e}(),_=function e(){Object(l.a)(this,e)};_.CHUNK_HALF_DIM=((_.CHUNK_DIM=9)-1)/2,_.DROP_NODES_CHANCE=0,function(e){e.Basic="Basic",e.Nothing="Nothing",e.EfficiencyGate="EfficiencyGate"}(k||(k={})),function(e){e.Mana0="Mana0",e.Mana1="Mana1",e.Mana2="Mana2"}(w||(w={})),function(e){e.Flat="Flat",e.Increased0="% increased",e.AfterIncreased0="added after % increased",e.Increased1="% increased multiplier",e.AfterIncreased1="added after % increased multiplier"}(E||(E={})),function(e){e.NOOP="NOOP",e.PAN_NORTH="PAN_NORTH",e.PAN_SOUTH="PAN_SOUTH",e.PAN_WEST="PAN_WEST",e.PAN_EAST="PAN_EAST",e.TRAVEL_UPSTAIRS="TRAVEL_UPSTAIRS",e.TRAVEL_DOWNSTAIRS="TRAVEL_DOWNSTAIRS",e.TOGGLE_STRATEGIC_VIEW="TOGGLE_STRATEGIC_VIEW",e.TOGGLE_SIDEBAR="TOGGLE_SIDEBAR",e.MOVE_CURSOR_WEST="MOVE_CURSOR_WEST",e.MOVE_CURSOR_EAST="MOVE_CURSOR_EAST",e.MOVE_CURSOR_NORTH="MOVE_CURSOR_NORTH",e.MOVE_CURSOR_SOUTH="MOVE_CURSOR_SOUTH",e.MOVE_CURSOR_NORTHWEST="MOVE_CURSOR_NORTHWEST",e.MOVE_CURSOR_NORTHEAST="MOVE_CURSOR_NORTHEAST",e.MOVE_CURSOR_SOUTHWEST="MOVE_CURSOR_SOUTHWEST",e.MOVE_CURSOR_SOUTHEAST="MOVE_CURSOR_SOUTHEAST",e.INTERACT_WITH_NODE="INTERACT_WITH_NODE"}(T||(T={}));var C,I,U=m(T).reduce((function(e,t){return e[t]=!1,e}),{});!function(e){e.TAKEN="TAKEN",e.AVAILABLE="AVAILABLE",e.UNREACHABLE="UNREACHABLE",e.HIDDEN="HIDDEN"}(C||(C={})),function(e){e.true="true",e.false="false"}(I||(I={}));var M,R={true:{taken:!0},false:{taken:!1}},A={true:{visible:!0},false:{visible:!1}},D={true:{reachable:!0},false:{reachable:!1}};!function(e){e.CLOSED="CLOSED",e.TICKING="TICKING",e.OPEN="OPEN"}(M||(M={}));var L=function(){function e(t){Object(l.a)(this,e),this.type=void 0,this.modifier=void 0,this.type=t.type,this.modifier=t.modifier}return Object(h.a)(e,[{key:"hash",value:function(){return this.type.toString()+","+this.modifier.toString()}}]),e}(),P={w:T.PAN_NORTH,a:T.PAN_WEST,s:T.PAN_SOUTH,d:T.PAN_EAST,k:T.PAN_NORTH,h:T.PAN_WEST,j:T.PAN_SOUTH,l:T.PAN_EAST,m:T.TOGGLE_STRATEGIC_VIEW,i:T.TOGGLE_SIDEBAR,ArrowUp:T.MOVE_CURSOR_NORTH,ArrowLeft:T.MOVE_CURSOR_WEST,ArrowDown:T.MOVE_CURSOR_SOUTH,ArrowRight:T.MOVE_CURSOR_EAST," ":T.INTERACT_WITH_NODE,"<":T.TRAVEL_UPSTAIRS,">":T.TRAVEL_DOWNSTAIRS},z=function(e){Object(b.a)(n,e);var t=Object(y.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleKeydown=function(e){var t=a.state.keyIntentConfig[e.key];t&&e.preventDefault(),!1===e.repeat&&void 0!==t&&t!==T.NOOP&&(a.props.updaters.newIntent[t].enqueueUpdate((function(){return a.props.updaters.newIntent[t].enqueueUpdate((function(){return!1})),!0})),a.props.updaters.activeIntent[t].enqueueUpdate((function(){return!0})))},a.handleKeyup=function(e){var t=a.state.keyIntentConfig[e.key];void 0!==t&&t!==T.NOOP&&(a.props.updaters.activeIntent[t].enqueueUpdate((function(){return!1})),a.props.updaters.endedIntent[t].enqueueUpdate((function(){return a.props.updaters.endedIntent[t].enqueueUpdate((function(){return!1})),!0})))},a.state={keyIntentConfig:P},document.addEventListener("keydown",a.handleKeydown),document.addEventListener("keyup",a.handleKeyup),a}return Object(h.a)(n,[{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeydown),document.removeEventListener("keyup",this.handleKeyup)}},{key:"render",value:function(){return Object(a.jsx)(a.Fragment,{children:" "})}}]),n}(r.a.Component),G=r.a.createContext([]),H=n(8),F=n(11),W=n(47),q={backgroundBlue:2236962,nodePink:3355443,nodeLavender:4934475,nodeBlue:14540253,nodeAqua:16755370,gateTint:16777215,selectedTint:12303359,allocatedTint:4473924,nodeBorder:6710886,nullTint:16777215,tooltipBorderBlack:2236962,tooltipFillWhite:15658734,white:16777215,grayBlack:1907997,borderBlack:1118481,borderWhite:6710886,black:0,textWhite:8947848};function V(e){return"#"+e.toString(16)}var X=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(l.a)(this,e),this._values=void 0,this._values=new B;var n,a=Object(g.a)(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;this.put(i)}}catch(r){a.e(r)}finally{a.f()}}return Object(h.a)(e,[{key:"remove",value:function(e){this._values.remove(e)}},{key:"put",value:function(e){this._values.put(e,e)}},{key:"get",value:function(e){return void 0!==this._values.get(e)}},{key:"contains",value:function(e){return this._values.contains(e)}},{key:"values",value:function(){return this._values.values()}},{key:"clone",value:function(){var t=new e;return t._values=this._values.clone(),t}},{key:"size",value:function(){return this._values.size()}},{key:"equals",value:function(e){if(void 0===e||null===e)return!1;if(this.size()!==e.size())return!1;var t,n=Object(g.a)(this.values());try{for(n.s();!(t=n.n()).done;){var a=t.value;if(!e.contains(a))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}}]),e}(),B=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(l.a)(this,e),this._values={};var n,a=Object(g.a)(t);try{for(a.s();!(n=a.n()).done;){var i=Object(u.a)(n.value,2),r=i[0],o=i[1];this.put(r,o)}}catch(c){a.e(c)}finally{a.f()}}return Object(h.a)(e,[{key:"put",value:function(e,t){this._values[e.hash()]=t}},{key:"remove",value:function(e){delete this._values[e.hash()]}},{key:"get",value:function(e){return this._values[e.hash()]}},{key:"contains",value:function(e){return void 0!==this.get(e)&&e.hash()in this._values}},{key:"values",value:function(){return Object.values(this._values)}},{key:"size",value:function(){return Object.keys(this._values).length}},{key:"clone",value:function(){var t=new e;return t._values=Object(F.a)({},this._values),t}}]),e}(),K=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(l.a)(this,e),this._kvalues={};var n,a=Object(g.a)(t);try{for(a.s();!(n=a.n()).done;){var i=Object(u.a)(n.value,2),r=i[0],o=i[1];this.put(r,o)}}catch(c){a.e(c)}finally{a.f()}}return Object(h.a)(e,[{key:"put",value:function(e,t){this._kvalues[e.hash()]=[e,t]}},{key:"remove",value:function(e){delete this._kvalues[e.hash()]}},{key:"get",value:function(e){var t;return null===(t=this._kvalues[e.hash()])||void 0===t?void 0:t[1]}},{key:"contains",value:function(e){return void 0!==this.get(e)&&e.hash()in this._kvalues}},{key:"keys",value:function(){var e=this;return Object.keys(this._kvalues).map((function(t){return e._kvalues[t][0]}))}},{key:"entries",value:function(){var e=this;return Object.keys(this._kvalues).map((function(t){return e._kvalues[t]}))}},{key:"values",value:function(){var e=this;return Object.keys(this._kvalues).map((function(t){return e._kvalues[t][1]}))}},{key:"hashKeyset",value:function(){return Object.keys(this._kvalues).map((function(e){return Z(e)})).reduce((function(e,t){return e+t})).toString()}},{key:"clone",value:function(){var t=new e;return t._kvalues=Object(F.a)({},this._kvalues),t}},{key:"size",value:function(){return Object.keys(this._kvalues).length}}]),e}();function Z(e){for(var t=0,n=0;n<e.length;n++)t=Math.imul(31,t)+e.charCodeAt(n)|0;return t}function J(e){return new H.d(e.x,e.y)}var Y=n(16);function Q(e){var t=[];return[function(e){t.push(e)},function(){if(0!==t.length){var n=Object(Y.a)(t);t=[],e((function(e){var t,a=e,i=Object(g.a)(n);try{for(i.s();!(t=i.n()).done;){var r=t.value;a="function"===typeof r?r(a):r}}catch(o){i.e(o)}finally{i.f()}return a}))}}]}var $=n(5);function ee(e,t){var n={getUpdater:function(){return t}};return n.enqueueUpdate=t,"object"!==typeof e||Object.keys(e).forEach((function(a){if("enqueueUpdate"===a||"getUpdater"===a||"update"===a)throw Error("Invalid key in updaterGenerator: ".concat(a," conflicts with reserved keywords enqueueUpdate, update, getUpdater."));n[a]=ee(e[a],(function(e){t("function"===typeof e?function(t,n){var i=e(t[a],n);return t[a]===i?t:Object(F.a)(Object(F.a)({},t),{},Object($.a)({},a,i))}:function(t,n){return Object(F.a)(Object(F.a)({},t),{},Object($.a)({},a,e))})}))})),n}function te(e,t){return ee(e,(function(e){t("function"===typeof e?function(t){return e(t,t)}:e)}))}var ne=function(){function e(){Object(l.a)(this,e),this._values=[]}return Object(h.a)(e,[{key:"add",value:function(e){-1===this._values.indexOf(e)||e.instance&&this.contains(e.instance),this._values.push(e)}},{key:"remove",value:function(e){var t=this._values.splice(this._values.findIndex((function(t){return t.instance===e})),1);return 0===t.length?void 0:t[0]}},{key:"contains",value:function(e){return this._values.findIndex((function(t){return t.instance===e}))>-1}},{key:"get",value:function(e){return this._values.find((function(t){return t.instance===e}))}},{key:"clone",value:function(){var t=new e;return t._values=Object(Y.a)(this._values),t}},{key:"forEach",value:function(e){this._values.forEach(e)}}]),e}(),ae=function(){function e(t){var n=this;Object(l.a)(this,e),this.container=void 0,this.state=void 0,this._staleProps=void 0,this._children=new ne,this._childrenToConstruct=new ne,this._childrenToDestruct=new ne,this._forceUpdates=new ne,this.markForceUpdate=function(e){var t,a;null===(t=n._staleProps.args)||void 0===t||null===(a=t.markForceUpdate)||void 0===a||a.call(t,n);var i=n._children.get(e);if(!i)throw new Error("Error, child ".concat(e," not found in ").concat(n));n._forceUpdates.add(i)},this._staleProps=t}return Object(h.a)(e,[{key:"addChild",value:function(e){this._children.add(e),this._childrenToConstruct.add(e)}},{key:"registerChild",value:function(e){this._children.add(e)}},{key:"removeChild",value:function(e){var t=this._children.remove(e);t&&this._childrenToDestruct.add(t)}},{key:"_didConstruct",value:function(e){var t,n=this;this._childrenToConstruct.forEach((function(t){t.instance||(t.instance=new t.childClass(t.propsFactory(e,n.state))),n.container.addChild(t.instance.container)})),this.renderSelf(e),null===(t=this.didMount)||void 0===t||t.call(this)}},{key:"useState",value:function(e,t){var n=function(t){e.state="function"===typeof t?t(e.state):t},a=Q(n),i=Object(u.a)(a,2),r=i[0];return{state:t,setState:n,fireStateUpdaters:i[1],stateUpdaters:te(t,r)}}},{key:"update",value:function(e){this._update(e)}},{key:"_update",value:function(e){var t,n,a,i=this,r=Object(F.a)({},this.state);if(null===(t=this.fireStateUpdaters)||void 0===t||t.call(this),null===(n=this.updateSelf)||void 0===n||n.call(this,e),this.shouldUpdate&&!this.shouldUpdate(this._staleProps,r,e,this.state)){var o,c=this._forceUpdates.clone();return this._forceUpdates=new ne,c.forEach((function(t){var n,a=t.instance,r=t.propsFactory;null===a||void 0===a||a._update(r(e,i.state)),a&&(null===(n=i.didForceUpdateChild)||void 0===n||n.call(i,a))})),void(null===(o=this.didForceUpdate)||void 0===o||o.call(this))}null===(a=this.updateChildren)||void 0===a||a.call(this,e),this._updateChildren(e),this.renderSelf(e),this._staleProps=e,new Promise((function(e){var t;return e(null===(t=i.didUpdate)||void 0===t?void 0:t.call(i))}))}},{key:"_updateChildren",value:function(e){var t=this;this._childrenToDestruct.forEach((function(e){var n,a;e.instance&&(null===(n=(a=e.instance).willUnmount)||void 0===n||n.call(a),t.container.removeChild(e.instance.container))})),this._childrenToDestruct=new ne,this._children.forEach((function(n){var a=n.instance,i=n.propsFactory;null===a||void 0===a||a._update(i(e,t.state))})),this._childrenToConstruct.forEach((function(n){n.instance||(n.instance=new n.childClass(n.propsFactory(e,t.state))),t.container.addChild(n.instance.container)})),this._childrenToConstruct=new ne}},{key:"willUnmount",value:function(){}},{key:"toString",value:function(){return"lifecyclehandler object"}}]),e}();function ie(e){return new Proxy(e,{construct:function(e,t){var n=new e(t[0]);return n._didConstruct(t[0]),n}})}var re;new Proxy(ae,{construct:function(e,t,n){var a=Reflect.construct(e,t,n);return a._didConstruct.apply(a,Object(Y.a)(t)),a}});function oe(e){var t,n={},a=function(e){var t,n=new B,a=Object(g.a)(e.playerSave.allocatedPointNodeHistory);try{for(a.s();!(t=a.n()).done;){var i=t.value,r=e.worldGen.zLevels[i.z].chunks.get(i.chunkCoord).pointNodes.get(i.pointNodeCoord);if(r.nodeType!==k.Nothing){var o=new L({type:r.resourceType,modifier:r.resourceModifier});n.put(o,(n.get(o)||0)+r.resourceAmount)}}}catch(c){a.e(c)}finally{a.f()}return n}(e),i=Object(g.a)(m(w));try{for(i.s();!(t=i.n()).done;){var r=t.value,o=a.get(new L({type:r,modifier:E.Flat}))||0;o*=1+.01*(a.get(new L({type:r,modifier:E.Increased0}))||0),o=Math.floor(o),o+=a.get(new L({type:r,modifier:E.AfterIncreased0}))||0,o*=1+.01*(a.get(new L({type:r,modifier:E.Increased1}))||0),o=Math.floor(o),o+=a.get(new L({type:r,modifier:E.AfterIncreased1}))||0,n[r]=o}}catch(c){i.e(c)}finally{i.f()}return{playerResourceAmounts:n,playerResourceNodesAggregated:a}}function ce(e,t){var n,a=function(e,t){var n={},a=t.zLevels[e.z],i=a.chunks.get(e.chunkCoord);if(e.pointNodeCoord.x===_.CHUNK_HALF_DIM){var r=e.chunkCoord.addX(1),o=a.chunks.get(r);if(o){var c=e.pointNodeCoord.withX(-_.CHUNK_HALF_DIM),u=o.pointNodes.get(c);u&&(n.EAST=new N({z:e.z,chunkCoord:r,pointNodeCoord:c,pointNodeId:u.id}))}}else{var s=e.pointNodeCoord.addX(1),d=i.pointNodes.get(s);d&&(n.EAST=new N({z:e.z,chunkCoord:e.chunkCoord,pointNodeCoord:s,pointNodeId:d.id}))}if(e.pointNodeCoord.x===-_.CHUNK_HALF_DIM){var l=e.chunkCoord.addX(-1),h=a.chunks.get(l);if(h){var f=e.pointNodeCoord.withX(_.CHUNK_HALF_DIM),p=h.pointNodes.get(f);p&&(n.WEST=new N({z:e.z,chunkCoord:l,pointNodeCoord:f,pointNodeId:p.id}))}}else{var v=e.pointNodeCoord.addX(-1),b=i.pointNodes.get(v);b&&(n.WEST=new N({z:e.z,chunkCoord:e.chunkCoord,pointNodeCoord:v,pointNodeId:b.id}))}if(e.pointNodeCoord.equals(x.Zero)){var y=t.zLevels[e.z+1];if(y){var O=e.chunkCoord,g=Math.round(O.x/_.CHUNK_DIM),S=O.x-_.CHUNK_DIM*g,j=Math.round(O.y/_.CHUNK_DIM),m=O.y-_.CHUNK_DIM*g,k=new x(g,j),w=y.chunks.get(k);if(w){var E=new x(S,m),T=w.pointNodes.get(E);T&&(n.UP=new N({z:e.z+1,chunkCoord:k,pointNodeCoord:E,pointNodeId:T.id}))}}}var C=t.zLevels[e.z-1];if(C){var I=e.chunkCoord.multiply(9).add(e.pointNodeCoord),U=C.chunks.get(I);if(U){var M=U.pointNodes.get(x.Zero);M&&(n.DOWN=new N({z:e.z-1,chunkCoord:I,pointNodeCoord:x.Zero,pointNodeId:M.id}))}}return n}(e,t),i=[],r=Object(g.a)(m(re));try{for(r.s();!(n=r.n()).done;){var o=a[n.value];o&&i.push(o)}}catch(c){r.e(c)}finally{r.f()}return i}function ue(e,t,n){if("yes"===function(e,t,n,a){if(n.contains(e))return"already allocated";var i,r=ce(e,t),o=!1,c=Object(g.a)(r);try{for(c.s();!(i=c.n()).done;){var u=i.value;n.contains(u)&&(o=!0)}}catch(s){c.e(s)}finally{c.f()}return o?"yes":"not connected"}(n,t.worldGen,t.playerSave.allocatedPointNodeSet,t.playerSave.activeQuest)&&function(e,t){var n,a=null===(n=t.worldGen.zLevels[e.z].chunks.get(e.chunkCoord))||void 0===n?void 0:n.pointNodes.get(e.pointNodeCoord);if(a.nodeType!==k.EfficiencyGate)return!0;var i,r=a.efficiencyGateInfo.thresholdResourceType;return((null===(i=t.computed.playerResourceAmounts)||void 0===i?void 0:i[r])||0)>=a.efficiencyGateInfo.thresholdResourceAmount&&t.playerSave.allocatedPointNodeHistory.length<=a.efficiencyGateInfo.timeUntilLocked}(n,t)){var a=e.allocatedPointNodeSet.clone();a.put(n);var i=Object(Y.a)(e.allocatedPointNodeHistory);return i.push(n),[Object(F.a)(Object(F.a)({},e),{},{allocatedPointNodeHistory:i,allocatedPointNodeSet:a}),!0]}return[e,!1]}function se(e,t){var n=!1,a=!1,i=!1;e.playerUI.selectedPointNode.enqueueUpdate((function(e,a){return(null===e||void 0===e?void 0:e.pointNodeId)===t.pointNodeId&&(n=!0),t})),e.playerSave.enqueueUpdate((function(e,r){if(n){n=!1;var o=ue(e,r,t),c=Object(u.a)(o,2),s=c[0];return c[1]?(a=!0,s):(i=!0,e)}return e})),e.computed.enqueueUpdate((function(e,t){return a?oe(t):e})),e.playerSave.enqueueUpdate((function(e,t){return a?(a=!1,function(e,t){var n=Object(F.a)({},e);if(void 0!==n.spSpentThisQuest&&(n.spSpentThisQuest+=1),n.activeQuest){var a,i=n.activeQuest.resourceType,r=(null===(a=t.computed.playerResourceAmounts)||void 0===a?void 0:a[i])||0;n.questProgressHistory=[].concat(Object(Y.a)(n.questProgressHistory),[r])}return n}(e,t)):e})),e.playerUI.activeTab.enqueueUpdate((function(e,t){return i?(i=!1,1):e}))}!function(e){e.NORTHWEST="NORTHWEST",e.SOUTHWEST="SOUTHWEST",e.NORTHEAST="NORTHEAST",e.SOUTHEAST="SOUTHEAST",e.EAST="EAST",e.WEST="WEST",e.UP="UP",e.DOWN="DOWN"}(re||(re={}));var de=ie(function(e){Object(b.a)(n,e);var t=Object(y.a)(n);function n(e){var a,i,r;Object(l.a)(this,n),(r=t.call(this,e)).container=void 0,r.state=void 0,r.sprite=void 0,r.halfwayCenterSprite=void 0,r.centerSprite=void 0,r.topHalfSprite=void 0,r.hitArea=void 0,r.tooltippableArea=void 0,r.state={numClicks:0,descriptionText:""},r.updateSelf(e),r.container=new H.b;var o=null===(a=e.args.pointNodeTexture.find((function(e){return e.cropFraction>=.99})))||void 0===a?void 0:a.texture;r.container.sortableChildren=!0,r.sprite=new H.g(o),r.sprite.anchor.x=.5,r.sprite.anchor.y=.5,r.sprite.zIndex=-2,r.container.addChild(r.sprite),r.topHalfSprite=new H.g(null===(i=e.args.pointNodeTexture.find((function(e){return e.cropFraction>=.499})))||void 0===i?void 0:i.texture),r.topHalfSprite.anchor.x=.5,r.topHalfSprite.anchor.y=.5,r.topHalfSprite.zIndex=-1,e.pointNodeGen.nodeType===k.EfficiencyGate&&r.container.addChild(r.topHalfSprite);var c=new H.c;return c.beginFill(q.black),c.drawRect(0,0,r.topHalfSprite.width,r.topHalfSprite.height/2),c.pivot.x=r.topHalfSprite.width/2,c.pivot.y=r.topHalfSprite.height/2,c.zIndex=30,r.centerSprite=new H.g(o),r.centerSprite.anchor.x=.5,r.centerSprite.anchor.y=.5,r.centerSprite.scale=J(new x(.5,.5)),r.centerSprite.zIndex=1,r.centerSprite.alpha=0,r.halfwayCenterSprite=new H.g(o),r.halfwayCenterSprite.anchor.x=.5,r.halfwayCenterSprite.anchor.y=.5,r.halfwayCenterSprite.scale=J(new x(.75,.75)),r.halfwayCenterSprite.zIndex=0,r.halfwayCenterSprite.alpha=0,r.container.interactive=!0,r.container.buttonMode=!0,r.hitArea=new H.e(-le.NODE_HITAREA_PX/2,-le.NODE_HITAREA_PX/2,le.NODE_HITAREA_PX,le.NODE_HITAREA_PX),r.container.hitArea=r.hitArea,r}return Object(h.a)(n,[{key:"updateSelf",value:function(e){var t="Nothing (empty node)";e.pointNodeGen.nodeType===k.EfficiencyGate?t="Unlocks at 300 Mana0 in 14 or fewer allocations":e.pointNodeGen.nodeType!==k.Nothing&&(t="".concat(e.pointNodeGen.resourceAmount," ").concat(e.pointNodeGen.resourceModifier," ").concat(e.pointNodeGen.resourceType)),this.state.descriptionText=t}},{key:"renderSelf",value:function(e){var t,n,a;this.container.position=J(e.args.position),e.isSelected?(n=q.selectedTint,a=q.selectedTint):(n=q.nullTint,a=q.nullTint),e.isAllocated&&(n=q.allocatedTint);var i=0,r=0;e.pointNodeGen.nodeType===k.Nothing?i=q.nodeBlue:e.pointNodeGen.nodeType===k.EfficiencyGate?(i=q.nodeAqua,r=j(q.nodeAqua,q.gateTint)):e.pointNodeGen.resourceType===w.Mana0&&(e.pointNodeGen.resourceModifier===E.Flat?i=q.nodePink:e.pointNodeGen.resourceModifier===E.Increased0&&(i=q.nodeLavender)),this.sprite.tint=j(i,n),this.centerSprite.tint=j(i,a),this.topHalfSprite.tint=j(r,n);var o=Math.floor(9*Math.random())/8-.001;this.topHalfSprite.texture=null===(t=e.args.pointNodeTexture.find((function(e){return e.cropFraction>=o})))||void 0===t?void 0:t.texture,e.selfPointNodeRef.pointNodeCoord.equals(x.Zero)&&(this.container.scale=J(new x(1.25,1.25)))}},{key:"shouldUpdate",value:function(e,t,n,a){var i,r=Object(g.a)(Object.keys(e));try{for(r.s();!(i=r.n()).done;){var o=i.value;if("delta"!==o&&"args"!==o&&"updaters"!==o){if(e[o]!==n[o])return console.log("node shouldUpdate differed in ".concat(o,", returning true")),!0;var c,u;if("selfPointNodeRef"!==o);else if((null===(c=e[o])||void 0===c?void 0:c.hash())!==(null===(u=n[o])||void 0===u?void 0:u.hash()))return console.log("node shouldUpdate differed in ".concat(o,", returning true")),!0}}}catch(s){r.e(s)}finally{r.f()}return!1}},{key:"didMount",value:function(){var e=this,t=this._staleProps.updaters;this.container.addListener("pointerdown",(function(n){e._staleProps.args.markForceUpdate(e),e.state.numClicks++,se(t,e._staleProps.selfPointNodeRef)})),this.container.addListener("pointerover",(function(t){var n=t.data.getLocalPosition(e.container),a=new x(e.container.worldTransform.tx,e.container.worldTransform.ty);e._staleProps.tooltipUpdaters.enqueueUpdate((function(t){return Object(F.a)(Object(F.a)({},t),{},{visible:!0,text:e.state.descriptionText,position:a.add(n)})}))})),this.container.addListener("pointerout",(function(t){e._staleProps.tooltipUpdaters.enqueueUpdate((function(e){return Object(F.a)(Object(F.a)({},e),{},{visible:!1,text:""})}))})),this.container.addListener("pointermove",(function(t){var n=t.data.getLocalPosition(e.container),a=new x(e.container.worldTransform.tx,e.container.worldTransform.ty);e._staleProps.tooltipUpdaters.position.enqueueUpdate(a.add(n))}))}},{key:"toString",value:function(){return"PointNodeCompoent "+this._staleProps.selfPointNodeRef.toString()}}]),n}(ae)),le=function e(){Object(l.a)(this,e)};le.SPACING_PX=36,le.CHUNK_SPACING_PX=(_.CHUNK_DIM+0)*le.SPACING_PX,le.NODE_SIZE_PX=22,le.NODE_HITAREA_PX=le.NODE_SIZE_PX+4,le.NODE_ROUNDED_PX=4;ie(function(e){Object(b.a)(n,e);var t=Object(y.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).container=void 0,a.state=void 0,a.children=void 0,a.state={},a.container=new H.b,a.children=new K,a.resyncChildren(e),a}return Object(h.a)(n,[{key:"renderSelf",value:function(e){this.container.position=J(e.position)}},{key:"shouldUpdate",value:function(e,t,n,a){var i,r=Object(g.a)(Object.keys(e));try{for(r.s();!(i=r.n()).done;){var o=i.value;if("delta"!==o&&"args"!==o&&"updaters"!==o){if("position"===o){if(e[o].equals(n[o]))continue;return console.log("chunk shouldUpdate differed in ".concat(o,", returning true")),!0}var c,u;if("selectedPointNode"!==o)if("selfChunkRef"!==o){if("allocatedPointNodeSubset"===o){if(e[o].equals(n[o]))continue;return console.log("chunk shouldUpdate differed in ".concat(o,", returning true")),!0}if(e[o]!==n[o])return console.log("chunk shouldUpdate differed in ".concat(o,", returning true")),!0}else{var s,d;if((null===(s=e[o])||void 0===s?void 0:s.hash())!==(null===(d=n[o])||void 0===d?void 0:d.hash()))return console.log("chunk shouldUpdate differed in ".concat(o,", returning true")),!0}else if((null===(c=e[o])||void 0===c?void 0:c.hash())!==(null===(u=n[o])||void 0===u?void 0:u.hash()))return console.log("chunk shouldUpdate differed in ".concat(o,", returning true")),!0}}}catch(l){r.e(l)}finally{r.f()}return!1}},{key:"resyncChildren",value:function(e){var t=this,n=this.children.clone();console.log("chunk component upsert children got here");var a,i=Object(g.a)(e.chunkGen.pointNodes.entries());try{var r=function(){var i=Object(u.a)(a.value,2),r=i[0],o=i[1],c=new N({z:e.selfChunkRef.z,chunkCoord:e.selfChunkRef.chunkCoord,pointNodeCoord:r,pointNodeId:o.id}),s=function(e,n){var a;return{delta:e.delta,args:{pointNodeTexture:e.args.pointNodeTexture,markForceUpdate:t.markForceUpdate,position:c.pointNodeCoord.multiply(le.SPACING_PX)},selfPointNodeRef:c,updaters:e.updaters,tooltipUpdaters:e.tooltipUpdaters,pointNodeGen:o,isSelected:(null===(a=e.selectedPointNode)||void 0===a?void 0:a.pointNodeId)===c.pointNodeId,isAllocated:e.allocatedPointNodeSubset.contains(c)}},d=c,l=t.children.get(d);l?n.remove(d):(l=new de(s(e,t.state)),t.children.put(c,l),t.addChild({childClass:de,instance:l,propsFactory:s}))};for(i.s();!(a=i.n()).done;)r()}catch(h){i.e(h)}finally{i.f()}console.log("chunk component to delete has ".concat(n.size()," children"));var o,c=Object(g.a)(n.entries());try{for(c.s();!(o=c.n()).done;){var s=Object(u.a)(o.value,2),d=s[0],l=s[1];this.children.remove(d),this.removeChild(l)}}catch(h){c.e(h)}finally{c.f()}}},{key:"updateChildren",value:function(e){this.resyncChildren(e)}},{key:"didForceUpdateChild",value:function(e){this.container.removeChild(e.container),this.container.addChild(e.container)}}]),n}(ae));var he=function(){function e(t){Object(l.a)(this,e),this._wasConstructed=!1,this._value=void 0,this._factory=void 0,this._factory=t}return Object(h.a)(e,[{key:"get",value:function(){return void 0!==this._value||!0===this._wasConstructed||(this._value=this._factory(),this._wasConstructed=!0),this._value}},{key:"wasConstructed",value:function(){return this._wasConstructed}}]),e}();var fe=function(){function e(t){Object(l.a)(this,e),this._values=void 0,this._factory=void 0,this._values=new K,this._factory=t}return Object(h.a)(e,[{key:"setFactory",value:function(e){return this._factory=e,this}},{key:"put",value:function(e,t){this._values.put(e,t)}},{key:"remove",value:function(e){this._values.remove(e)}},{key:"invalidate",value:function(e){this.remove(e)}},{key:"clear",value:function(){this._values=new K}},{key:"peek",value:function(e){return this._values.get(e)}},{key:"get",value:function(e){if(this._values.contains(e))return this._values.get(e);var t=this._factory(e);return this._values.put(e,t),t}},{key:"precompute",value:function(e){if(!this._values.contains(e)){var t=this._factory(e);this._values.put(e,t)}}},{key:"contains",value:function(e){return this._values.contains(e)}},{key:"values",value:function(){return this._values.values()}},{key:"keys",value:function(){return this._values.keys()}},{key:"entries",value:function(){return this._values.entries()}},{key:"size",value:function(){return this._values.size()}},{key:"clone",value:function(t){var n=new e(t||this._factory);return n._values=this._values.clone(),n}}]),e}(),pe=ie(function(e){Object(b.a)(n,e);var t=Object(y.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).container=void 0,a.state=void 0,a.container=new H.b,a.container.sortableChildren=!0,a.state={},a}return Object(h.a)(n,[{key:"renderSelf",value:function(e){}}]),n}(ae)),ve=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,z:0},n=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;Object(l.a)(this,e),this._x=void 0,this._y=void 0,this._z=void 0,"number"===typeof t?(this._x=t,this._y=n,this._z=a):(this._x=t.x,this._y=t.y,this._z=t.z)}return Object(h.a)(e,[{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}},{key:"z",get:function(){return this._z}}]),Object(h.a)(e,[{key:"hash",value:function(){return this.toString()}},{key:"toString",value:function(){return"[".concat(this.x,", ").concat(this.y,", ").concat(this.z,"]")}},{key:"subtract",value:function(t){return new e({x:this.x-t.x,y:this.y-t.y,z:this.z-t.z})}},{key:"add",value:function(t,n,a){return new e("number"===typeof t?{x:this.x+t,y:this.y+n,z:this.z+a}:{x:this.x+t.x,y:this.y+t.y,z:this.z+t.z})}},{key:"addX",value:function(t){return new e({x:this.x+t,y:this.y,z:this.z})}},{key:"addY",value:function(t){return new e({x:this.x,y:this.y+t,z:this.z})}},{key:"addZ",value:function(t){return new e({x:this.x,y:this.y,z:this.z+t})}},{key:"subtractX",value:function(t){return new e({x:this.x-t,y:this.y,z:this.z})}},{key:"subtractY",value:function(t){return new e({x:this.x,y:this.y-t,z:this.z})}},{key:"subtractZ",value:function(t){return new e({x:this.x,y:this.y,z:this.z-t})}},{key:"scale",value:function(t,n){return new e({x:(this.x-t.x)*n.x+t.x,y:(this.y-t.y)*n.y+t.y,z:(this.z-t.z)*n.z+t.z})}},{key:"equals",value:function(e){return void 0!==e&&(Math.abs(this.x-e.x)<O&&Math.abs(this.y-e.y)<O&&Math.abs(this.z-e.z)<O)}},{key:"multiply",value:function(t){return new e("number"===typeof t?{x:this.x*t,y:this.y*t,z:this.z*t}:{x:this.x*t.x,y:this.y*t.y,z:this.z*t.z})}},{key:"divide",value:function(t){return new e("number"===typeof t?{x:this.x/t,y:this.y/t,z:this.z/t}:{x:this.x/t.x,y:this.y/t.y,z:this.z/t.z})}},{key:"toJSON",value:function(){return{__type:"Vector3",x:this.x,y:this.y,z:this.z}}},{key:"pairXY",value:function(){return new x({x:this.x,y:this.y})}},{key:"withX",value:function(t){return new e({x:t,y:this.y,z:this.z})}},{key:"withY",value:function(t){return new e({x:this.x,y:t,z:this.z})}},{key:"withZ",value:function(t){return new e({x:this.x,y:this.y,z:t})}}],[{key:"IsVector3",value:function(t){return t instanceof e}},{key:"FromVector2",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new e(t.x,t.y,n)}},{key:"Deserialize",value:function(t){return t.hasOwnProperty("x")&&t.hasOwnProperty("y")&&t.hasOwnProperty("z")||console.error("Failed deserializing vector3"),new e({x:t.x,y:t.y,z:t.z})}},{key:"Serialize",value:function(e){return JSON.stringify({x:e.x,y:e.y})}}]),e}();ve.Zero=new ve(0,0,0),ve.One=new ve(1,1,1);var be=ie(function(e){Object(b.a)(n,e);var t=Object(y.a)(n);function n(e){var a;Object(l.a)(this,n),(a=t.call(this,e)).container=void 0,a.state=void 0,a.graphics=void 0,a.hexGrid=new K,a.state={numClicks:0,descriptionText:""},a.updateSelf(e),a.container=new H.b,a.graphics=new H.g,a.graphics.texture=e.args.textures.circle,a.graphics.tint=q.borderBlack,a.graphics.visible=!1,a.container.addChild(a.graphics);for(var i=-20;i<=20;i++)for(var r=-35+Math.floor(i/2);r<=35+Math.floor(i/2);r++){var o=new H.g;o.texture=e.args.textures.circle,o.tint=q.nodePink,o.position=J(e.appSize.divide(2).add(new x(30*r-15*i,-26*i))),a.container.addChild(o),a.hexGrid.put(new x(r,i),o)}return a}return Object(h.a)(n,[{key:"updateSelf",value:function(e){}},{key:"renderSelf",value:function(e){this.container.position=J(e.args.position),this.graphics.position=J(e.appSize.divide(2));var t,n=Object(g.a)(this.hexGrid.entries());try{for(n.s();!(t=n.n()).done;){var a=Object(u.a)(t.value,2),i=a[0],r=a[1];r.position=J(e.appSize.divide(2).add(new x(30*i.x-15*i.y,-26*i.y)));var o=e.virtualGridLocation.add(ve.FromVector2(i)),c=e.fogOfWarStatusMap.get(o)||A.false,s=e.allocationStatusMap.get(o)||R.false,d=e.reachableStatusMap.get(o)||D.false,l=e.lockMap.get(o),h=e.lockStatusMap.get(o);s.taken?(r.visible=!0,r.tint=q.borderBlack):d.reachable?l&&h!==M.OPEN?(r.visible=!0,r.tint=q.nodePink):(r.visible=!0,r.tint=q.nodeLavender):c.visible?(r.visible=!0,r.tint=q.nodePink):r.visible=!1,l&&h!==M.OPEN?(r.texture=e.args.textures.rect,r.position.x-=e.args.textures.rect.width/2,r.position.y-=e.args.textures.rect.height/2):(r.texture=e.args.textures.circle,r.position.x-=e.args.textures.circle.width/2,r.position.y-=e.args.textures.circle.height/2)}}catch(f){n.e(f)}finally{n.f()}}},{key:"shouldUpdate",value:function(e,t,n,a){var i,r=Object(g.a)(Object.keys(e));try{for(r.s();!(i=r.n()).done;){var o=i.value;if("args"!==o&&e[o]!==n[o])return console.log("hexgrid shouldUpdate differed in ".concat(o,", returning true")),!0}}catch(c){r.e(c)}finally{r.f()}return!1}}]),n}(ae));var ye=ie(function(e){Object(b.a)(n,e);var t=Object(y.a)(n);function n(e){var a;Object(l.a)(this,n),(a=t.call(this,e)).container=void 0,a.state=void 0,a.stateUpdaters=void 0,a.fireStateUpdaters=void 0,a.fixedCameraStage=void 0,a.actionStage=void 0,a.backdropStage=void 0,a.strategicHexGrid=void 0,a.backdrop=void 0,a.container=new H.b,a.container.sortableChildren=!0;var i=a.useState(Object(W.a)(a),{pointNodeTexture:new he((function(){return function(e){for(var t=[],n=0;n<=8;n++){var a=n/8,i=new H.c;i.beginFill(q.white),i.drawRoundedRect(-le.NODE_SIZE_PX/2,-le.NODE_SIZE_PX/2,le.NODE_SIZE_PX,le.NODE_SIZE_PX,le.NODE_ROUNDED_PX);var r=new H.c;r.beginFill(q.black),r.drawRect(-le.NODE_SIZE_PX/2,-le.NODE_SIZE_PX/2,le.NODE_SIZE_PX,le.NODE_SIZE_PX*a),i.mask=r;var o=e.generateTexture(i,H.f.LINEAR,1);t.push({cropFraction:a,texture:o})}return t}(e.args.renderer)})),simpleTexture:new he((function(){return function(e){var t=new H.c;t.beginFill(q.white),t.drawCircle(0,0,8);var n=new H.c;n.beginFill(q.white),n.drawRect(0,0,4,20);var a=new H.c;return a.beginFill(q.white),a.drawRect(0,0,16,16),{circle:e.generateTexture(t,H.f.LINEAR,1),rect:e.generateTexture(n,H.f.LINEAR,1),square:e.generateTexture(a,H.f.LINEAR,1)}}(e.args.renderer)})),tick:0,playerCurrentZ:0,tooltip:{visible:!1,position:void 0,text:""}});a.state=i.state,a.stateUpdaters=i.stateUpdaters,a.fireStateUpdaters=i.fireStateUpdaters;var r=function(e,t){return{args:{renderer:e.args.renderer,markForceUpdate:a.markForceUpdate},delta:e.delta,gameState:e.gameState,appSize:e.appSize,tick:t.tick,tooltip:Object(F.a)({},t.tooltip)}};a.fixedCameraStage=new pe(r(e,a.state)),a.addChild({childClass:pe,instance:a.fixedCameraStage,propsFactory:r}),a.actionStage=new H.g,a.actionStage.zIndex=0,a.actionStage.sortableChildren=!0,a.container.addChild(a.actionStage);var o=function(e,t){return{args:{position:x.Zero,textures:t.simpleTexture.get()},appSize:e.appSize,virtualGridLocation:e.gameState.playerUI.virtualGridLocation,allocationStatusMap:e.gameState.playerSave.allocationStatusMap,fogOfWarStatusMap:e.gameState.computed.fogOfWarStatusMap,reachableStatusMap:e.gameState.computed.reachableStatusMap,lockStatusMap:e.gameState.computed.lockStatusMap,lockMap:e.gameState.worldGen.lockMap}};return a.strategicHexGrid=new be(o(e,a.state)),a.addChild({childClass:be,instance:a.strategicHexGrid,propsFactory:o}),a.backdropStage=new H.g,a.backdropStage.zIndex=-1,a.backdropStage.sortableChildren=!0,a.container.addChild(a.backdropStage),a.backdrop=new H.c,a.backdropStage.addChild(a.backdrop),a.backdrop.beginFill(q.backgroundBlue,1),a.backdrop.interactive=!0,a.backdrop.drawRect(0,0,e.appSize.x,e.appSize.y),a}return Object(h.a)(n,[{key:"updateSelf",value:function(e){this.state.tick++}},{key:"renderSelf",value:function(e){this.backdrop.width=e.appSize.x,this.backdrop.height=e.appSize.y}},{key:"didMount",value:function(){}},{key:"didUpdate",value:function(){}}]),n}(ae));function Oe(e){return new x({x:Math.min(1920,((null===e||void 0===e?void 0:e.x)||1/0)-24),y:Math.min(1080,((null===e||void 0===e?void 0:e.y)||1/0)-24)})}var ge=function(){function e(t){var n;Object(l.a)(this,e),this.app=void 0,this.state=void 0,this.props=void 0,this.staleProps=void 0,this.rootComponent=void 0,this.onTick=void 0,null===t||void 0===t||null===(n=t.args)||void 0===n||n.isSecondConstructorCall;var a=new x(800,600);this.state={appSize:a,originalAppSize:a},this.app=new H.a({width:this.state.appSize.x,height:this.state.appSize.y,antialias:!0,transparent:!0,resolution:window.devicePixelRatio||1,autoDensity:!0,powerPreference:"low-power",backgroundColor:q.white})}return Object(h.a)(e,[{key:"pause",value:function(){this.app.ticker.remove(this.onTick)}},{key:"destroy",value:function(){this.app.destroy(!0,{children:!0,texture:!0,baseTexture:!0})}},{key:"didMount",value:function(){var e=this;this.onTick=function(t){return e.baseGameLoop(t)},this.onTick=this.onTick.bind(this),this.app.ticker.add(this.onTick),this.state.appSize=Oe(new x(this.props.gameState.windowState.innerWidth,this.props.gameState.windowState.innerHeight))}},{key:"register",value:function(e){e.appendChild(this.app.view)}},{key:"updateSelf",value:function(e,t){e!==t?(e.gameState.windowState.innerWidth===(null===t||void 0===t?void 0:t.gameState.windowState.innerWidth)&&e.gameState.windowState.innerHeight===(null===t||void 0===t?void 0:t.gameState.windowState.innerHeight)||(this.state.appSize=Oe(new x(e.gameState.windowState.innerWidth,e.gameState.windowState.innerHeight))),e.updaters.tick.enqueueUpdate((function(e){return e+1}))):e.updaters.tick.enqueueUpdate((function(e){return e+1}))}},{key:"rerender",value:function(e){this.rootComponent&&this.props===e||(this.props=e,this.rootComponent||(this.rootComponent=new ye({args:{renderer:this.app.renderer,markForceUpdate:function(){}},updaters:this.props.updaters,delta:0,gameState:this.props.gameState,appSize:this.state.appSize}),this.app.stage.addChild(this.rootComponent.container),this.renderSelf(this.props),this.didMount()))}},{key:"renderSelf",value:function(e){this.app.renderer.resize(this.state.appSize.x,this.state.appSize.y)}},{key:"baseGameLoop",value:function(e){var t;if(this.props.gameState.playerUI.isPixiHidden)return this.props.updaters.tick.enqueueUpdate((function(e){return e+1})),void this.props.args.fireBatch();this.updateSelf(this.props,this.staleProps),null===(t=this.rootComponent)||void 0===t||t.update({args:{renderer:this.app.renderer,markForceUpdate:function(){}},updaters:this.props.updaters,delta:e,gameState:this.props.gameState,appSize:this.state.appSize}),this.renderSelf(this.props),this.staleProps=this.props,this.props.args.fireBatch()}}]),e}(),Se=new he((function(){return new ge}));function je(e){var t=Object(i.useState)(Se.get()),n=Object(u.a)(t,1)[0],r=Object(i.useRef)(null),o=Object(i.useContext)(G),c=Object(u.a)(o,3),s=c[0],d=c[1],l=c[2];return Object(i.useEffect)((function(){for(var e=r.current.childNodes.length-1;e>=0;e--)r.current.removeChild(r.current.childNodes[e]);r.current.appendChild(n.app.view)}),[n]),Object(i.useEffect)((function(){n.rerender({args:{fireBatch:l,isSecondConstructorCall:!1},updaters:d,gameState:s})}),[n,l,d,s]),Object(a.jsx)(a.Fragment,{children:Object(a.jsx)("div",{ref:r,hidden:e.hidden,style:{}})})}var me,xe=function(e){Object(b.a)(n,e);var t=Object(y.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).handleWindowResize=function(e){a.props.updaters.enqueueUpdate((function(e){return Object(F.a)(Object(F.a)({},e),{},{innerWidth:window.innerWidth,innerHeight:window.innerHeight})}))},a.state={},window.addEventListener("resize",a.handleWindowResize),a}return Object(h.a)(n,[{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleWindowResize)}},{key:"render",value:function(){return Object(a.jsx)(a.Fragment,{children:" "})}}]),n}(r.a.Component);function ke(e){var t={};return t.EAST=e.addX(1),t.WEST=e.addX(-1),t.NORTHWEST=e.addY(1),t.SOUTHEAST=e.addY(-1),t.NORTHEAST=e.add(1,1,0),t.SOUTHWEST=e.add(-1,-1,0),t}function we(e,t,n,a){var i=new X,r=new X;i.put(e);for(var o=[[e]],c=1;c<=t;c++){o.push([]);var u,s=Object(g.a)(o[c-1]);try{for(s.s();!(u=s.n()).done;)for(var d=u.value,l=Object.values(ke(d)),h=0,f=l;h<f.length;h++){var p=f[h];p&&(i.get(p)||((null===a||void 0===a?void 0:a.contains(p))?r.put(p):(i.put(p),o[c].push(p))))}}catch(y){s.e(y)}finally{s.f()}}for(var v=[],b=n||0;b<=t;b++)v=v.concat(o[b]);return v=v.concat(r.values())}!function(e){e.NORTHWEST="NORTHWEST",e.SOUTHWEST="SOUTHWEST",e.NORTHEAST="NORTHEAST",e.SOUTHEAST="SOUTHEAST",e.EAST="EAST",e.WEST="WEST",e.UP="UP",e.DOWN="DOWN"}(me||(me={}));var Ee,Te,Ne,_e,Ce=n(6),Ie=function(){function e(t){Object(l.a)(this,e),this.config=void 0,this.chunkGenFactory=void 0,this.config=t,this.chunkGenFactory=new Ue({})}return Object(h.a)(e,[{key:"create",value:function(e){for(var t=Object(Ce.b)(e.seed+e.z),n=new K,a=e.startingChunks||3,i=-a;i<=a;i++)for(var r=-a;r<=a;r++){var o=new x(i,r);n.put(o,this.chunkGenFactory.create({seed:t,location:o,z:e.z}))}return{id:t,chunks:n}}}]),e}(),Ue=function(){function e(t){Object(l.a)(this,e),this.config=void 0,this.pointNodeGenFactory=void 0,this.config=t,this.pointNodeGenFactory=new Me({})}return Object(h.a)(e,[{key:"create",value:function(e){for(var t=Object(Ce.b)(e.seed+Object(Ce.b)(e.seed+e.location.x)+e.location.y),n=new K,a=new X,i=-_.CHUNK_HALF_DIM;i<=_.CHUNK_HALF_DIM;i++)for(var r=-_.CHUNK_HALF_DIM;r<=_.CHUNK_HALF_DIM;r++)0===i&&0===r||Object(Ce.b)(t+i*_.CHUNK_DIM+r)/Ce.a<_.DROP_NODES_CHANCE/4&&(a.put(new x(i,r)),a.put(new x(r,-i)),a.put(new x(-i,-r)),a.put(new x(-r,i)));for(var o=-_.CHUNK_HALF_DIM;o<=_.CHUNK_HALF_DIM;o++)for(var c=-_.CHUNK_HALF_DIM;c<=_.CHUNK_HALF_DIM;c++){var u=new x(o,c);a.get(u)||n.put(u,this.pointNodeGenFactory.create({seed:t,location:u,chunk:e.location,z:e.z}))}return{id:t,pointNodes:n}}}]),e}(),Me=function(){function e(t){Object(l.a)(this,e),this.config=void 0,this.config=t}return Object(h.a)(e,[{key:"create",value:function(e){var t,n=Object(Ce.b)(e.seed+Object(Ce.b)(e.seed+e.location.x)+e.location.y),a=Object(Ce.b)(n+1)/Ce.a,i=w.Mana2,r=k.Nothing;a<0?r=k.Nothing:a<.15?(r=k.Basic,i=w.Mana0):a<.35?(r=k.EfficiencyGate,i=w.Mana0):a<-.35?(r=k.Basic,i=w.Mana1):a<-.6?(r=k.Basic,i=w.Mana2):r=k.Nothing,e.location.equals(x.Zero)&&e.chunk.equals(x.Zero)&&0===e.z&&(r=k.Nothing);var o=0;if((t=(a=Object(Ce.b)(n+2)/Ce.a)<.55?E.Flat:a<-.7?E.AfterIncreased0:a<-.7?E.AfterIncreased1:a<1.95?E.Increased0:E.Increased1)===E.Flat||t===E.AfterIncreased0||t===E.AfterIncreased1?(a=Math.floor(Object(Ce.b)(n+3)/Ce.a*4),a+=Math.floor(Object(Ce.b)(n+4)/Ce.a*4),o=20*(a+=Math.floor(Object(Ce.b)(n+5)/Ce.a*4))+60):(a=Math.floor(Object(Ce.b)(n+3)/Ce.a*2),a+=Math.floor(Object(Ce.b)(n+4)/Ce.a*2),a+=Math.floor(Object(Ce.b)(n+5)/Ce.a*2),o=(a+=Math.floor(Object(Ce.b)(n+6)/Ce.a*3))+3),r===k.Nothing)return{id:n,nodeType:r};if(r===k.EfficiencyGate){return{id:n,resourceAmount:o,resourceModifier:t,resourceType:i,nodeType:r,efficiencyGateInfo:{thresholdResourceAmount:300,thresholdResourceType:w.Mana0,timeUntilLocked:14}}}return{id:n,resourceAmount:o,resourceModifier:t,resourceType:i,nodeType:r}}}]),e}();function Re(e){for(var t=e.randInt,n=e.weights,a=e.behaviors,i=t/Ce.a,r=Object(Ce.b)(t),o=i*Object.values(n).reduce((function(e,t){return e+t})),c=0,s=Object.entries(n);c<s.length;c++){var d=Object(u.a)(s[c],2),l=d[0],h=d[1];if(o<=h)return a[l](r);o-=h}throw Error()}function Ae(e){var t,n=e.randInt,a=e.weights,i=n/Ce.a*Object.values(a).reduce((function(e,t){return e+t})),r=Object(g.a)(Object.entries(a));try{for(r.s();!(t=r.n()).done;){var o=Object(u.a)(t.value,2),c=o[0],s=o[1];if(i<=s)return c;i-=s}}catch(d){r.e(d)}finally{r.f()}throw Error()}function De(e){var t=e.randInt,n=e.min,a=e.max,i=e.increment,r=void 0===i?1:i,o=e.inclusive,c=void 0===o||o,u=t/Ce.a,s=Math.ceil((a-n)/r);return n+r*s===a&&!0===c&&(s+=1),n+Math.floor(u*s)*r}!function(e){e.RED0="RED0",e.RED1="RED1",e.RED2="RED2",e.DEL0="DEL0",e.DEL1="DEL1",e.DEL2="DEL2"}(Ne||(Ne={})),function(e){e.FLAT="FLAT",e.INCREASED="INCREASED"}(_e||(_e={}));var Le={DECISION_0:{EMPTY:800,NO_SPEND:100,SPEND:0},DECISION_1:{SINGLE:500,DOUBLE:0},SINGLE_COLORS:(Ee={},Object($.a)(Ee,Ne.RED0,100),Object($.a)(Ee,Ne.RED1,100),Object($.a)(Ee,Ne.RED2,100),Object($.a)(Ee,Ne.DEL0,10),Object($.a)(Ee,Ne.DEL1,10),Object($.a)(Ee,Ne.DEL2,10),Ee),SINGLE_MODIFIERS:(Te={},Object($.a)(Te,_e.FLAT,100),Object($.a)(Te,_e.INCREASED,75),Te)},Pe=function(){function e(t){Object(l.a)(this,e),this.config=void 0,this.config=t}return Object(h.a)(e,[{key:"createSingle",value:function(e){var t=Ae({randInt:e.randInt,weights:Le.SINGLE_COLORS}),n=Ae({randInt:Object(Ce.b)(e.randInt),weights:Le.SINGLE_MODIFIERS}),a=0;return a=n===_e.FLAT?function(e){for(var t=e.randInt,n=e.formula,a=e.plus,i=void 0===a?0:a,r=parseInt(n.split("d")[0]),o=parseInt(n.split("d")[1]),c=0,u=0;u<r;u++)c+=De({randInt:Object(Ce.b)(t+u),min:1,max:o,inclusive:!0});return c+i}({randInt:Object(Ce.b)(e.randInt+1),formula:"2d6",plus:8}):De({randInt:Object(Ce.b)(e.randInt+2),min:4,max:7,increment:.5,inclusive:!0}),{attribute:Ne[t],amount:a,modifier:_e[n]}}},{key:"createNoSpend",value:function(e){var t=this;return Re({randInt:e.randInt,weights:Le.DECISION_1,behaviors:{SINGLE:function(e){return{lines:[t.createSingle({randInt:e})]}},DOUBLE:function(e){return{lines:[t.createSingle({randInt:e}),t.createSingle({randInt:Object(Ce.b)(e)})]}}}})}},{key:"create",value:function(e){var t=this,n=e.seed,a=e.location;return a.equals(ve.Zero)?{lines:[]}:Re({randInt:Object(Ce.b)(n+a.x+a.y+Object(Ce.b)(n+a.x+a.z)),weights:Le.DECISION_0,behaviors:{EMPTY:function(e){return{lines:[]}},NO_SPEND:function(e){return t.createNoSpend({randInt:e})},SPEND:function(e){var n,a=t.createNoSpend({randInt:e}),i=Ae({randInt:e,weights:(n={},Object($.a)(n,Ne.RED0,100),Object($.a)(n,Ne.RED1,100),Object($.a)(n,Ne.RED2,100),Object($.a)(n,Ne.DEL0,0),Object($.a)(n,Ne.DEL1,0),Object($.a)(n,Ne.DEL2,0),n)});return Object(F.a)(Object(F.a)({},a),{},{condition:{type:"SPEND",amount:12,attribute:Ne[i]}})}}})}}]),e}(),ze=function(){function e(t){Object(l.a)(this,e),this.updaters=void 0,this.updaters=t}return Object(h.a)(e,[{key:"enqueueAction",value:function(e){var t,n,a,i=e.nodeLocation,r=e.newStatus;this.updaters.playerSave.allocationStatusMap.enqueueUpdate((function(e){return e.put(i,r),e.clone()})),null===(t=this.updaters.computed.lockStatusMap)||void 0===t||t.enqueueUpdate((function(e,t){if(!e)return e;var n,a=Object(g.a)(t.worldGen.lockMap.entries());try{for(a.s();!(n=a.n()).done;){var i=Object(u.a)(n.value,2),r=i[0];if(i[1]){var o=M.TICKING;e.put(r,o)}}}catch(c){a.e(c)}finally{a.f()}return e.clone()})),null===(n=this.updaters.computed.reachableStatusMap)||void 0===n||n.enqueueUpdate((function(e){return e?(we(i,1).forEach((function(t){e.put(t,D.true)})),e.clone()):e})),null===(a=this.updaters.computed.fogOfWarStatusMap)||void 0===a||a.enqueueUpdate((function(e,t){return e?(e.put(i,A.true),we(i,1).forEach((function(t){e.put(t,A.true)})),we(i,6,0,{contains:function(e){var n,a=null===(n=t.computed.lockStatusMap)||void 0===n?void 0:n.get(e);return!(!a||a===M.OPEN)}}).forEach((function(n){var a;(null===(a=e.get(n))||void 0===a?void 0:a.visible)||(t.worldGen.lockMap.precompute(n),e.put(n,A.true))})),e.clone()):e}))}}]),e}(),Ge=function(){function e(t){Object(l.a)(this,e),this.config=void 0,this.config=t}return Object(h.a)(e,[{key:"create",value:function(e){var t=Object(Ce.b)(e.seed+e.location.x+e.location.y+Object(Ce.b)(e.seed+e.location.x+e.location.z))/Ce.a,n={shortTextTarget:"\ud83d\udd12",shortTextTimer:"",lockStatus:M.TICKING};if(!e.location.equals(ve.Zero))return t<.37?n:void 0}}]),e}(),He=function(){function e(t){Object(l.a)(this,e),this.config=void 0,this.config=t}return Object(h.a)(e,[{key:"create",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,a=n||103043,i=new Ie({}).create({seed:a,z:0,startingChunks:0}),r=new x(0,0),o=null===(e=i.chunks.get(r))||void 0===e||null===(t=e.pointNodes.get(r))||void 0===t?void 0:t.id,c=new N({z:0,chunkCoord:r,pointNodeId:o,pointNodeCoord:r}),s={orientation:"original",innerWidth:window.innerWidth,innerHeight:window.innerHeight},d=new Ge({}),l=new fe((function(e){return d.create({seed:a,location:e})})),h=new Pe({}),f=new fe((function(e){return h.create({seed:a,location:e})})),p={tick:0,worldGen:{seed:a,zLevels:{0:i},lockMap:l,nodeContentsMap:f},playerSave:{activeQuest:void 0,spSpentThisQuest:void 0,questProgressHistory:[],questInitialAmount:0,questsCompleted:[],allocatedPointNodeSet:new X([c]),allocatedPointNodeHistory:[c],score:0,allocationStatusMap:new K([[ve.Zero,R.true]])},playerUI:{selectedPointNode:void 0,activeTab:0,isPixiHidden:!0,virtualGridLocation:ve.Zero,cursoredNodeLocation:void 0,isSidebarOpen:!1},computed:{},intent:{activeIntent:U,newIntent:U,endedIntent:U},windowState:s,debug:{retriggerVirtualGridDims:function(){},debugShowScrollbars:!1,rerenderGameAreaGrid:function(){},enableScrollJump:!0,getForceJumpOffset:function(){},getOffsetX:function(){},isFlipCursored:function(){}}};p.computed=Object(F.a)({},oe(p)),p.computed.lockStatusMap=new B,p.computed.fogOfWarStatusMap=new B,p.computed.reachableStatusMap=new B,we(ve.Zero,6).forEach((function(e){p.worldGen.lockMap.precompute(e)}));var v,b=p.computed.lockStatusMap,y=p,O=Object(g.a)(y.worldGen.lockMap.entries());try{for(O.s();!(v=O.n()).done;){var S=Object(u.a)(v.value,2),j=S[0],m=S[1];if(m){var k=M.TICKING;b.put(j,k)}}}catch(I){O.e(I)}finally{O.f()}var w=p.computed.fogOfWarStatusMap,E=p.computed.reachableStatusMap,T=ve.Zero,_=p;w.put(T,A.true),we(T,1).forEach((function(e){w.put(e,A.true),E.put(e,D.true)}));var C={contains:function(e){var t,n=null===(t=_.computed.lockStatusMap)||void 0===t?void 0:t.get(e);return!(!n||n===M.OPEN)}};return we(T,6,0,C).forEach((function(e){var t;(null===(t=w.get(e))||void 0===t?void 0:t.visible)||(_.worldGen.lockMap.precompute(e),w.put(e,A.true))})),p}}]),e}(),Fe=r.a.memo(We);function We(e){var t=e.hexGridPx,n=e.borderWidth,r=e.hexCenterRadius,o=e.appSize,c=e.COLORS;return Object(i.useEffect)((function(){document.documentElement.style.setProperty("--grid-width"," ".concat(t.x,"px")),document.documentElement.style.setProperty("--grid-height"," ".concat(t.y,"px")),document.documentElement.style.setProperty("--hex-center-radius"," ".concat(r,"px")),document.documentElement.style.setProperty("--border-width"," ".concat(n,"px"))}),[t,r,n]),Object(i.useEffect)((function(){document.documentElement.style.setProperty("--background-black",V(c.backgroundBlue)),document.documentElement.style.setProperty("--deemphasized-black",V(c.grayBlack)),document.documentElement.style.setProperty("--active-purple",V(c.nodePink)),document.documentElement.style.setProperty("--border-unimportant-black",V(c.borderBlack)),document.documentElement.style.setProperty("--border-important-white",V(c.borderWhite)),document.documentElement.style.setProperty("--text-readable-white",V(c.textWhite))}),[c]),Object(i.useEffect)((function(){document.documentElement.style.setProperty("--app-size-width"," ".concat(o.x,"px")),document.documentElement.style.setProperty("--app-size-height"," ".concat(o.y,"px"))}),[o]),Object(a.jsx)(a.Fragment,{children:e.children})}n(124),n(70);var qe,Ve,Xe,Be,Ke=(qe={},Object($.a)(qe,Ne.RED0,"\ud83d\udd34"),Object($.a)(qe,Ne.RED1,"\ud83d\udfe2"),Object($.a)(qe,Ne.RED2,"\ud83d\udd35"),Object($.a)(qe,Ne.DEL0,"\u2694\ufe0f"),Object($.a)(qe,Ne.DEL1,"\ud83d\udee1"),Object($.a)(qe,Ne.DEL2,"\u2728"),qe),Ze=(Ve={},Object($.a)(Ve,Ne.RED0,"Red"),Object($.a)(Ve,Ne.RED1,"Green"),Object($.a)(Ve,Ne.RED2,"Blue"),Object($.a)(Ve,Ne.DEL0,"Offense"),Object($.a)(Ve,Ne.DEL1,"Defense"),Object($.a)(Ve,Ne.DEL2,"Magic"),Ve),Je=(Xe={},Object($.a)(Xe,_e.FLAT,"+"),Object($.a)(Xe,_e.INCREASED,"%"),Xe);Be={},Object($.a)(Be,_e.FLAT,"flat"),Object($.a)(Be,_e.INCREASED,"increased");function Ye(e){return e.modifier===_e.FLAT?"+".concat(e.amount," ").concat(Ze[e.attribute]):"".concat(e.amount,"% increased ").concat(Ze[e.attribute])}var Qe="The starting node.";function $e(e){var t=e.location,n=e.gameState.computed,i=n.fogOfWarStatusMap,r=n.reachableStatusMap,o=(n.lockStatusMap,e.gameState.playerSave.allocationStatusMap),c=e.gameState.worldGen,u=c.lockMap,s=c.nodeContentsMap,d=null===i||void 0===i?void 0:i.get(t),l=null===r||void 0===r?void 0:r.get(t),h=o.get(t),f=(null===h||void 0===h?void 0:h.taken)?C.TAKEN:(null===l||void 0===l?void 0:l.reachable)?C.AVAILABLE:(null===d||void 0===d?void 0:d.visible)?C.UNREACHABLE:C.HIDDEN,p=t.hash(),v=u.get(t),b=s.get(t),y="";b.lines[0]?(y+=Je[b.lines[0].modifier],y+=Ke[b.lines[0].attribute]):y="",b.lines[1]&&b.lines[0].attribute!==b.lines[1].attribute&&(y+=Ke[b.lines[1].attribute]);var O,g="";return b.condition&&(g="-"+Ke[b.condition.attribute]),{nodeLocation:t,shortText:g?Object(a.jsxs)(a.Fragment,{children:[y,Object(a.jsx)("br",{}),g]}):Object(a.jsx)(a.Fragment,{children:y}),toolTipText:Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{children:f.toString()}),t.equals(ve.Zero)?Object(a.jsxs)(a.Fragment,{children:[" ",Object(a.jsx)("br",{})," ",Object(a.jsx)("div",{children:Qe})]}):Object(a.jsx)(a.Fragment,{children:" "}),b.lines[0]?Object(a.jsx)("br",{}):Object(a.jsx)(a.Fragment,{}),Object(a.jsx)("div",{children:b.lines[0]&&Ye(b.lines[0])}),Object(a.jsx)("div",{children:b.lines[1]&&Ye(b.lines[1])}),Object(a.jsx)("div",{children:b.condition&&(O=b.condition,"SPEND: ".concat(O.amount," ").concat(Ze[O.attribute]))})]}),fullText:Object(a.jsx)(a.Fragment,{children:" "}),status:f,lockData:v,id:p}}n(231);var et=r.a.memo(tt);function tt(e){var t=e.id,n=e.onUpdateStatus,r=e.nodeData,o=e.isCursored,c=e.onUpdateCursored,u=(e.debugIsCursored,r.nodeLocation),s=Object(i.useCallback)((function(e){e.stopPropagation(),e.preventDefault(),n({nodeLocation:u,newStatus:C.TAKEN})}),[n,u]),d=Object(i.useCallback)((function(e){e.stopPropagation(),e.preventDefault(),c(o?void 0:u)}),[o,c,u]);return Object(a.jsx)(nt,{id:t,onClickCenter:s,nodeData:r,onClickQuestionMark:d,isCursored:o},t)}var nt=r.a.memo(at);function at(e){var t,n,i=e.id,r=e.onClickCenter,o=e.onClickQuestionMark,c=e.nodeData,u=e.isCursored,s=(e.debugIsCursored,+new Date);console.log("GameAreaCellComponent key: ".concat(i," rerendered at ").concat(s));var l=c.status,h=!!c.lockData;return Object(a.jsxs)("div",{className:"hex-block hex-full-block",id:i,children:[Object(a.jsx)("div",{className:d()("hex-center",l===C.TAKEN?"node-allocated":"node-unallocated",l===C.TAKEN||l===C.UNREACHABLE?"border-unimportant":"border-important"),onClick:r,hidden:l===C.HIDDEN,children:Object(a.jsx)("div",{className:"hex-center-text-wrapper",children:Object(a.jsx)("div",{className:"tiny-text",children:c.shortText})})}),h?Object(a.jsxs)("div",{className:"hex-center-lock",hidden:l===C.HIDDEN,children:[Object(a.jsx)("div",{className:"hex-center-lock-left",children:Object(a.jsx)("div",{className:"tiny-text",children:null===(t=c.lockData)||void 0===t?void 0:t.shortTextTarget})}),Object(a.jsx)("div",{className:"hex-center-lock-right",children:Object(a.jsx)("div",{className:"tiny-text",children:null===(n=c.lockData)||void 0===n?void 0:n.shortTextTimer})})]}):null,Object(a.jsx)("div",{className:"empty-positioned node-tooltip-wrapper",children:Object(a.jsx)("div",{hidden:!0,children:c.toolTipText})}),Object(a.jsx)("div",{className:"empty-positioned",children:Object(a.jsx)("div",{className:"hover-only-2 absolute-positioned",children:Object(a.jsx)("div",{className:"question",hidden:l===C.HIDDEN,onClick:o,children:"?"})})}),Object(a.jsx)("div",{className:"empty-positioned selection-cursor-wrapper",children:Object(a.jsx)("div",{className:"absolute-positioned selection-cursor",hidden:!u})})]},i)}var it=r.a.memo(rt);function rt(e){var t,n,r=e.gameState,o=e.virtualGridDims,c=e.virtualCoordsToLocation,u=e.updateNodeStatusByLocationCb,s=e.cursoredVirtualNode,d=e.setCursoredLocation,l=e.debug,h=+new Date;Object(i.useEffect)((function(){console.log("callbacks got refreshed!")}),[u,d]),null===l||void 0===l||l.rerenderGameAreaGrid();null===l||void 0===l||null===(t=l.getOffsetX)||void 0===t||t.call(l);var f=(null===l||void 0===l||null===(n=l.isFlipCursored)||void 0===n?void 0:n.call(l))||!1;console.log("Game area grid rerender");var p=Object(i.useMemo)((function(){return new fe((function(e){return $e({location:e,gameState:r})}))}),[r]),v=Object(a.jsx)(a.Fragment,{children:Array(o.y).fill(0).map((function(e,t){return Object(a.jsx)(ot,{rowIdx:t,children:Array(o.x).fill(0).map((function(e,n){var i=new x(n,t),r=c(i),o=p.get(r),l=!!s&&s.equals(i),h=o.id||"loading".concat(n);return Object(a.jsx)(et,{id:h,nodeData:o,onUpdateStatus:u,isCursored:l,debugIsCursored:f?!l:l,onUpdateCursored:d},h)}))},c(new x(0,t)).y.toString())}))}),b=+new Date,y=b-h;return console.log("Game area grid elapsed ".concat(y,"ms at ").concat(b)),v}var ot=r.a.memo(ct);function ct(e){var t=e.rowIdx,n=e.children,i=!!(t%2);return Object(a.jsxs)("div",{className:"hex-block-row",children:[i&&Object(a.jsx)("div",{className:"hex-block hex-half-block"}),n,!i&&Object(a.jsx)("div",{className:"hex-block hex-half-block"})]})}var ut=r.a.memo(st);function st(e){var t=e.hexGridPx,n=e.virtualGridDims,r=e.appSize,o=e.updaters,c=e.keyboardScrollDirection,s=e.debug,l=Object(i.useRef)(null),h=Object(i.useRef)(null),f=Object(i.useState)(new x(0,0)),p=Object(u.a)(f,2),v=p[0],b=p[1];Object(i.useEffect)((function(){null!=l.current&&l.current!==h.current&&(l.current.scrollTop=(n.y*t.y-r.y)/2,l.current.scrollLeft=((n.x+.5)*t.x-r.x)/2),h.current=l.current}),[r,n,t]),Object(i.useEffect)((function(){if(v){var e=l.current;e&&e.scrollTo(e.scrollLeft-v.x*t.x,e.scrollTop-v.y*t.y)}}),[v,t]);var y=Object(i.useCallback)((function(e){var t=n.multiply(.05).floor();t=t.clampX(1,n.x-1).clampY(1,n.y-1);var a=new x(e.direction.x,-1*e.direction.y);e.direction.x===e.direction.y&&(a=new x(0,-1*e.direction.y));var i=new x(a.x,0).add(new x(-.5,-1).multiply(a.y));o.playerUI.virtualGridLocation.enqueueUpdate((function(e){return e.add(ve.FromVector2(a,0))})),b(i)}),[n,o]),O=s.getForceJumpOffset;Object(i.useEffect)((function(){var e=null===O||void 0===O?void 0:O();e&&o.playerUI.virtualGridLocation.enqueueUpdate((function(t){return t.addX(e.x).add(new ve(-1,-2,0).multiply(e.y/2))}))}),[o,O]);var g=s.enableScrollJump,S=Object(i.useCallback)((function(e){if(g){var a={x:0,y:0},i=e.target,o=i.scrollTop,c=i.scrollLeft;i.scrollTop<.9*t.y&&(o+=2*t.y,a.y-=1),i.scrollTop>(n.y-.9)*t.y-r.y&&(o-=2*t.y,a.y+=1),i.scrollLeft<.9*t.x&&(c+=2*t.x,a.x-=1),i.scrollLeft>(n.x-.9)*t.x-r.x&&(c-=2*t.x,a.x+=1),i.scrollTop===o&&i.scrollLeft===c||y({direction:new x(a.x,a.y)})}}),[r,y,t,n,g]);return Object(i.useEffect)((function(){if(!c.equals(x.Zero)){var e=null,t=function(){var t=l.current;if(t){var n=x.Zero;if(null===e)n=c.multiply(8),e=+new Date;else{var a=+new Date-e;a>40&&console.log("WAS SLOW - "+a.toString()),n=c.multiply(a),e=+new Date}n=n.multiply(.75),t.scrollTo(t.scrollLeft+n.x,t.scrollTop-n.y)}},n=setInterval(t,8);return t(),function(){return clearInterval(n)}}}),[c]),Object(a.jsx)("div",{ref:l,className:d()({"game-area":!0,"hidden-scrollbars":!(null===s||void 0===s?void 0:s.debugShowScrollbars)}),hidden:e.hidden,onScroll:S,children:Object(a.jsx)("div",{className:"virtual-game-area",children:e.children})})}var dt=r.a.memo(lt);function lt(e){var t=e.gameState,n=e.appSize,r=e.virtualGridDims,o=Object(i.useCallback)((function(e){return function(e){var t=e.virtualCoords,n=e.virtualGridLocation,a=e.virtualGridDims.divide(2).floor(),i=t.subtract(a),r=x.Zero;return r=(r=i.y%2===0?new x(-1,-2).multiply(i.y/2):a.y%2===0?new x(0,-1).add(new x(-1,-2).multiply((i.y-1)/2)):new x(-1,-1).add(new x(-1,-2).multiply((i.y-1)/2))).addX(i.x),n.add(ve.FromVector2(r,0))}({virtualCoords:e,virtualGridDims:r,virtualGridLocation:t.playerUI.virtualGridLocation})}),[t.playerUI.virtualGridLocation,r]),c=Object(i.useCallback)((function(e){return function(e){var t=e.location,n=e.virtualGridLocation,a=e.virtualGridDims.divide(2).floor(),i=t.subtract(n),r=x.Zero;if(0===i.z)return r=(r=i.y%2===0?new x(-1,-2).multiply(i.y/2):a.y%2===0?new x(-1,-1).add(new x(-1,-2).multiply((i.y-1)/2)):new x(0,-1).add(new x(-1,-2).multiply((i.y-1)/2))).addX(i.x),a.add(r)}({location:e,virtualGridDims:r,virtualGridLocation:t.playerUI.virtualGridLocation})}),[t.playerUI.virtualGridLocation,r]),u=Object(i.useCallback)((function(n){var a,i,r=n.nodeLocation,o=n.newStatus,c=(null===(a=t.computed.reachableStatusMap)||void 0===a?void 0:a.get(r))||D.false;if(o===C.TAKEN){if(c!==D.true)return void console.log("cant do that, not reachable:",c);var u=t.worldGen.lockMap.get(r);if(u)return void console.log("is locked",u)}(null===(i=t.playerSave.allocationStatusMap.get(r))||void 0===i?void 0:i.taken)||e.actions.allocateNode.enqueueAction({nodeLocation:r,newStatus:R.true})}),[e.actions,t.playerSave.allocationStatusMap,t.computed.reachableStatusMap,t.worldGen.lockMap]),s=Object(i.useCallback)((function(e){var t=e.virtualCoords,n=e.newStatus,a=o(t);u({nodeLocation:a,newStatus:n})}),[o,u]),d=Object(i.useCallback)((function(t){e.updaters.playerUI.cursoredNodeLocation.enqueueUpdate((function(e){return t})),t&&e.updaters.playerUI.isSidebarOpen.enqueueUpdate((function(){return!0}))}),[e.updaters]),l=Object(i.useMemo)((function(){return t.playerUI.cursoredNodeLocation?c(t.playerUI.cursoredNodeLocation):void 0}),[t.playerUI.cursoredNodeLocation,c]);Object(i.useEffect)((function(){var t=o(r.divide(2).floor());e.gameState.intent.newIntent.MOVE_CURSOR_EAST&&e.updaters.playerUI.cursoredNodeLocation.enqueueUpdate((function(e){return(null===e||void 0===e?void 0:e.addX(1))||t})),e.gameState.intent.newIntent.MOVE_CURSOR_WEST&&e.updaters.playerUI.cursoredNodeLocation.enqueueUpdate((function(e){return(null===e||void 0===e?void 0:e.addX(-1))||t})),e.gameState.intent.newIntent.MOVE_CURSOR_NORTHEAST&&e.updaters.playerUI.cursoredNodeLocation.enqueueUpdate((function(e){return(null===e||void 0===e?void 0:e.add({x:1,y:1,z:0}))||t})),e.gameState.intent.newIntent.MOVE_CURSOR_NORTHWEST&&e.updaters.playerUI.cursoredNodeLocation.enqueueUpdate((function(e){return(null===e||void 0===e?void 0:e.addY(1))||t})),e.gameState.intent.newIntent.MOVE_CURSOR_SOUTHEAST&&e.updaters.playerUI.cursoredNodeLocation.enqueueUpdate((function(e){return(null===e||void 0===e?void 0:e.addY(-1))||t})),e.gameState.intent.newIntent.MOVE_CURSOR_SOUTHWEST&&e.updaters.playerUI.cursoredNodeLocation.enqueueUpdate((function(e){return(null===e||void 0===e?void 0:e.add({x:-1,y:-1,z:0}))||t})),e.gameState.intent.newIntent.MOVE_CURSOR_SOUTH&&e.updaters.playerUI.cursoredNodeLocation.enqueueUpdate((function(e){return e&&e.y%2===0?null===e||void 0===e?void 0:e.add({x:0,y:-1,z:0}):e&&e.y%2!==0?null===e||void 0===e?void 0:e.add({x:-1,y:-1,z:0}):t})),e.gameState.intent.newIntent.MOVE_CURSOR_NORTH&&e.updaters.playerUI.cursoredNodeLocation.enqueueUpdate((function(e){return e&&e.y%2===0?null===e||void 0===e?void 0:e.add({x:1,y:1,z:0}):e&&e.y%2!==0?null===e||void 0===e?void 0:e.add({x:0,y:1,z:0}):t})),e.gameState.intent.newIntent.INTERACT_WITH_NODE&&l&&s({virtualCoords:l,newStatus:C.TAKEN})}),[e.gameState.intent.newIntent.INTERACT_WITH_NODE,e.gameState.intent.newIntent.MOVE_CURSOR_EAST,e.gameState.intent.newIntent.MOVE_CURSOR_NORTH,e.gameState.intent.newIntent.MOVE_CURSOR_NORTHEAST,e.gameState.intent.newIntent.MOVE_CURSOR_NORTHWEST,e.gameState.intent.newIntent.MOVE_CURSOR_SOUTH,e.gameState.intent.newIntent.MOVE_CURSOR_SOUTHEAST,e.gameState.intent.newIntent.MOVE_CURSOR_SOUTHWEST,e.gameState.intent.newIntent.MOVE_CURSOR_WEST,e.updaters,o,r,l,s]);var h=Object(i.useMemo)((function(){var t=x.Zero;return e.gameState.intent.activeIntent.PAN_EAST&&(t=t.addX(1)),e.gameState.intent.activeIntent.PAN_WEST&&(t=t.addX(-1)),e.gameState.intent.activeIntent.PAN_NORTH&&(t=t.addY(1)),e.gameState.intent.activeIntent.PAN_SOUTH&&(t=t.addY(-1)),t}),[e.gameState.intent.activeIntent.PAN_EAST,e.gameState.intent.activeIntent.PAN_WEST,e.gameState.intent.activeIntent.PAN_NORTH,e.gameState.intent.activeIntent.PAN_SOUTH]),f=Object(i.useMemo)((function(){return{debugShowScrollbars:t.debug.debugShowScrollbars,enableScrollJump:t.debug.enableScrollJump,getForceJumpOffset:t.debug.getForceJumpOffset}}),[t.debug.debugShowScrollbars,t.debug.enableScrollJump,t.debug.getForceJumpOffset]),p=Object(i.useMemo)((function(){return{rerenderGameAreaGrid:t.debug.rerenderGameAreaGrid,getOffsetX:t.debug.getOffsetX,isFlipCursored:t.debug.isFlipCursored}}),[t.debug.rerenderGameAreaGrid,t.debug.getOffsetX,t.debug.isFlipCursored]),v=Object(i.useMemo)((function(){return{playerUI:{cursoredNodeLocation:t.playerUI.cursoredNodeLocation},playerSave:{allocationStatusMap:t.playerSave.allocationStatusMap},worldGen:{nodeContentsMap:t.worldGen.nodeContentsMap,lockMap:t.worldGen.lockMap},computed:{fogOfWarStatusMap:t.computed.fogOfWarStatusMap,reachableStatusMap:t.computed.reachableStatusMap,lockStatusMap:t.computed.lockStatusMap}}}),[t.playerUI.cursoredNodeLocation,t.playerSave.allocationStatusMap,t.worldGen.nodeContentsMap,t.worldGen.lockMap,t.computed.fogOfWarStatusMap,t.computed.reachableStatusMap,t.computed.lockStatusMap]);return Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(ut,{hidden:!t.playerUI.isPixiHidden,appSize:n,updaters:e.updaters,hexGridPx:ht,virtualGridDims:r,keyboardScrollDirection:h,debug:f,children:Object(a.jsx)(it,{gameState:v,virtualGridDims:r,virtualCoordsToLocation:o,updateNodeStatusByLocationCb:u,cursoredVirtualNode:l,setCursoredLocation:d,debug:p})})})}var ht=new x(268,232);function ft(e){var t=e.gameState,n=Object(i.useMemo)((function(){return function(e){return new x({x:Math.min(1920,((null===e||void 0===e?void 0:e.x)||1/0)-24),y:Math.min(1080,((null===e||void 0===e?void 0:e.y)||1/0)-24)})}(new x(t.windowState.innerWidth,t.windowState.innerHeight))}),[t.windowState.innerWidth,t.windowState.innerHeight]),r=t.debug.retriggerVirtualGridDims,o=Object(i.useMemo)((function(){r();var e=Math.floor(2*n.x/ht.x-.5),t=Math.floor(2*n.y/ht.y);return new x(e,t)}),[n,r]),c=Object(i.useMemo)((function(){return{playerUI:{virtualGridLocation:t.playerUI.virtualGridLocation,cursoredNodeLocation:t.playerUI.cursoredNodeLocation,isPixiHidden:t.playerUI.isPixiHidden},playerSave:{allocationStatusMap:t.playerSave.allocationStatusMap},worldGen:{nodeContentsMap:t.worldGen.nodeContentsMap,lockMap:t.worldGen.lockMap},computed:{fogOfWarStatusMap:t.computed.fogOfWarStatusMap,reachableStatusMap:t.computed.reachableStatusMap,lockStatusMap:t.computed.lockStatusMap},intent:t.intent,debug:{debugShowScrollbars:t.debug.debugShowScrollbars,rerenderGameAreaGrid:t.debug.rerenderGameAreaGrid,enableScrollJump:t.debug.enableScrollJump,getForceJumpOffset:t.debug.getForceJumpOffset,getOffsetX:t.debug.getOffsetX,isFlipCursored:t.debug.isFlipCursored}}}),[t.playerUI.virtualGridLocation,t.playerUI.cursoredNodeLocation,t.playerUI.isPixiHidden,t.playerSave.allocationStatusMap,t.worldGen.nodeContentsMap,t.worldGen.lockMap,t.computed.fogOfWarStatusMap,t.computed.reachableStatusMap,t.computed.lockStatusMap,t.intent,t.debug.debugShowScrollbars,t.debug.rerenderGameAreaGrid,t.debug.enableScrollJump,t.debug.getForceJumpOffset,t.debug.getOffsetX,t.debug.isFlipCursored]),u=Object(i.useMemo)((function(){return{allocateNode:new ze(e.updaters)}}),[e.updaters]);return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(Fe,{appSize:n,hexCenterRadius:48,hexGridPx:ht,borderWidth:2,COLORS:q}),Object(a.jsx)(dt,{appSize:n,virtualGridDims:o,gameState:c,updaters:e.updaters,actions:u})]})}n(232),n(233);function pt(e){var t=e.children,n=e.hidden,i=e.placement;return Object(a.jsx)("div",{className:"left"===i?"layout left-sidebar":"layout right-sidebar",hidden:n,children:Object(a.jsx)(a.Fragment,{children:t})})}n(234);var vt=r.a.memo(bt);function bt(e){var t=e.value,n=e.labels,i=e.onChange;return Object(a.jsx)("div",{className:"tab-label-container",children:n.map((function(e,n){return Object(a.jsx)(yt,{onClick:i,value:n,active:t===n,children:e},n)}))})}var yt=r.a.memo(Ot);function Ot(e){var t=e.onClick,n=e.value,r=e.active,o=e.children,c=Object(i.useCallback)((function(){t(n)}),[t,n]);return Object(a.jsx)("div",{className:r?"tab-label active":"tab-label inactive",children:Object(a.jsx)("div",{onClick:c,children:o})})}var gt;n(235);function St(e){var t,n=e.tabName,i=(t={},Object($.a)(t,gt.EMPTY,Object(a.jsx)(mt,{})),Object($.a)(t,gt.SELECTED_NODE,Object(a.jsx)(kt,{gameState:e.gameState})),Object($.a)(t,gt.STATS,Object(a.jsx)(a.Fragment,{children:"stats info???"})),Object($.a)(t,gt.QUESTS,Object(a.jsx)(a.Fragment,{children:"quests info???"})),Object($.a)(t,gt.DEBUG,Object(a.jsx)(Et,{gameState:e.gameState,updaters:e.updaters,hidden:n!==gt.DEBUG})),Object($.a)(t,gt.HELP,Object(a.jsx)(a.Fragment,{children:"How to play the game"})),t);return Object(a.jsx)(jt,{tabComponents:i,tabName:n})}function jt(e){var t=e.tabName,n=Object.keys(gt);return Object(a.jsx)(a.Fragment,{children:n.map((function(n){return Object(a.jsx)("div",{hidden:n!==t,children:e.tabComponents[n]},n)}))})}!function(e){e.EMPTY="EMPTY",e.SELECTED_NODE="SELECTED_NODE",e.STATS="STATS",e.QUESTS="QUESTS",e.DEBUG="DEBUG",e.HELP="HELP"}(gt||(gt={}));var mt=r.a.memo(xt);function xt(e){return console.log("got here empty tab content"),Object(a.jsx)("div",{children:"Nothing here!"})}var kt=r.a.memo(wt);function wt(e){var t,n,i,r,o,c,u,s=e.gameState,d=s.playerUI.cursoredNodeLocation;if(void 0===d)return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{children:"Nothing selected!"}),Object(a.jsx)("div",{children:Object(a.jsx)("br",{})}),Object(a.jsx)("div",{children:"Hover and click the question mark tooltip to select a node."})]});var l="";l=d.equals(ve.Zero)?Qe:void 0!==(null===(t=s.worldGen.lockMap)||void 0===t?void 0:t.get(d))?"A locked node.":"An allocatable node.";var h=new x(d.x-d.y/2,d.y*Math.sqrt(3)/2);h=new x(Math.round(100*h.x)/100,Math.round(100*h.y)/100);var f=((null===(n=s.playerSave.allocationStatusMap)||void 0===n||null===(i=n.get(d))||void 0===i?void 0:i.taken)||!1).toString(),p=((null===(r=s.computed.reachableStatusMap)||void 0===r||null===(o=r.get(d))||void 0===o?void 0:o.reachable)||!1).toString(),v=((null===(c=s.computed.fogOfWarStatusMap)||void 0===c||null===(u=c.get(d))||void 0===u?void 0:u.visible)||!1).toString();return Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)("div",{className:"tab-content-body",children:[Object(a.jsxs)("div",{children:["Location: ( ",h.x," , ",h.y," ) , z-layer = ",d.z]}),Object(a.jsx)("br",{}),Object(a.jsxs)("div",{children:["Description: ",l]}),Object(a.jsx)("br",{}),Object(a.jsxs)("div",{children:["Taken?: ",f]}),Object(a.jsxs)("div",{children:["Reachable?: ",p]}),Object(a.jsxs)("div",{children:["Visible?: ",v]}),Object(a.jsxs)("div",{children:["Locked?: ","???"]}),Object(a.jsx)("br",{}),Object(a.jsxs)("div",{children:["Contents: ","???"]})]})})}function Et(e){var t=e.gameState.tick,n=Object(i.useState)(+new Date),r=Object(u.a)(n,2),o=r[0],c=r[1],s=Object(i.useState)([]),d=Object(u.a)(s,2),l=d[0],h=d[1];Object(i.useEffect)((function(){var e=new Date,n=+e-o;if(n>30){var a="Tick ".concat(t," took ").concat(n,"ms at ").concat(e.toTimeString().split(" ")[0]);console.log(a),h((function(e){return[a].concat(Object(Y.a)(e))}))}c(+new Date)}),[t,o,c,h]);var f=Object(i.useCallback)((function(){console.log("tried triggered update from debug tab"),e.updaters.debug.retriggerVirtualGridDims.enqueueUpdate((function(e){return function(){console.log("force triggered update from debug tab")}}))}),[e.updaters]),p=Object(i.useCallback)((function(){var t;null===(t=e.updaters.debug.debugShowScrollbars)||void 0===t||t.enqueueUpdate((function(e){return!e}))}),[e.updaters]),v=Object(i.useCallback)((function(){e.updaters.debug.rerenderGameAreaGrid.enqueueUpdate((function(e){return function(){console.log("force triggered react rerender from debug tab")}}))}),[e.updaters]),b=Object(i.useCallback)((function(){e.updaters.debug.enableScrollJump.enqueueUpdate((function(){return!1}))}),[e.updaters]),y=Object(i.useCallback)((function(){e.updaters.debug.enableScrollJump.enqueueUpdate((function(){return!0}))}),[e.updaters]),O=Object(i.useCallback)((function(){e.updaters.debug.getForceJumpOffset.enqueueUpdate((function(e){return function(){return console.log("force triggered virtual jump only"),new x(1,2)}}))}),[e.updaters]),g=Object(i.useCallback)((function(){e.updaters.debug.getOffsetX.enqueueUpdate((function(e){var t=e()||0;return function(){return t+1}}))}),[e.updaters]),S=Object(i.useCallback)((function(){e.updaters.debug.isFlipCursored.enqueueUpdate((function(e){var t=e()||!1;return function(){return!t}}))}),[e.updaters]);return e.hidden?Object(a.jsx)(a.Fragment,{children:" "}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{children:" debug tab "}),Object(a.jsxs)("div",{className:"tab-content-body",children:[Object(a.jsx)("br",{}),Object(a.jsx)("div",{children:"Recent slow renders:"}),l.slice(0,5).map((function(e,t){return Object(a.jsx)("div",{children:e},t)})),Object(a.jsx)("br",{})]}),Object(a.jsx)("div",{children:" buttons "}),Object(a.jsxs)("div",{className:"tab-content-body",children:[Object(a.jsx)("br",{}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:p,children:"Toggle scrollbars"})}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:f,children:"Trigger virtual grid dims rerender"})}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:v,children:"Trigger only virtual game area grid react rerender"})}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:b,children:"Disable scroll jump trigger"})}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:y,children:"Reenable scroll jump trigger"})}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:O,children:"Force virtual grid jump only"})}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:g,children:"add weird x offset to grid"})}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{onClick:S,children:"weird flip cursored state on all nodes"})})]})]})}var Tt=["EMPTY"];function Nt(e){var t=e.gameState,n=e.updaters,r=Object(i.useCallback)((function(){n.playerUI.isSidebarOpen.enqueueUpdate((function(){return!1}))}),[n]),o=Object(i.useCallback)((function(){n.playerUI.isSidebarOpen.enqueueUpdate((function(){return!0}))}),[n]),c=Object(i.useCallback)((function(){n.playerUI.isSidebarOpen.enqueueUpdate((function(){return!1}))}),[n]),s=Object(i.useCallback)((function(){n.playerUI.isSidebarOpen.enqueueUpdate((function(){return!0}))}),[n]),d=Object(i.useState)([]),l=Object(u.a)(d,2),h=l[0],f=l[1],p=Object(i.useState)(["SELECTED_NODE","STATS","QUESTS","DEBUG","HELP"]),v=Object(u.a)(p,2),b=v[0],y=v[1],O=Object(i.useState)(0),g=Object(u.a)(O,2),S=g[0],j=g[1],m=Object(i.useState)(0),x=Object(u.a)(m,2),k=x[0],w=x[1],E=Object(i.useCallback)((function(){if(0!==b.length){var e=b[k];if(void 0!==e){var t=b.slice(0,k).concat(b.slice(k+1));y(t),w(Math.max(0,Math.min(k,t.length-1)));var n=[].concat(Object(Y.a)(h),[e]);f(n),j(n.length-1),o()}}}),[h,f,b,y,j,k,w,o]),T=Object(i.useCallback)((function(){if(0!==h.length){var e=h[S];if(void 0!==e){var t=h.slice(0,S).concat(h.slice(S+1));f(t),j(Math.max(Math.min(S,t.length-1),0));var n=[].concat(Object(Y.a)(b),[e]);y(n),w(n.length-1),s()}}}),[h,f,b,y,S,j,w,s]),N=Object(i.useMemo)((function(){return 0===h.length?gt.EMPTY:h[S]}),[h,S]),_=Object(i.useMemo)((function(){return 0===b.length?gt.EMPTY:b[k]}),[b,k]);return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)(pt,{hidden:!t.playerUI.isSidebarOpen,placement:"left",children:[Object(a.jsxs)("div",{className:"sidebar-header",children:[Object(a.jsx)("div",{className:"sidebar-header-button",onClick:T,children:"\u27a1\ufe0f\ufe0f Send right"}),Object(a.jsx)("div",{className:"sidebar-header-gap"}),Object(a.jsx)("div",{className:"sidebar-header-button",onClick:function(){r()},children:"\u274e Close"})]}),Object(a.jsx)(vt,{value:S||0,labels:h.length?h:Tt,onChange:j}),Object(a.jsx)(St,{gameState:t,updaters:n,tabName:N})]}),Object(a.jsxs)(pt,{hidden:!t.playerUI.isSidebarOpen,placement:"right",children:[Object(a.jsxs)("div",{className:"sidebar-header",children:[Object(a.jsx)("div",{className:"sidebar-header-button",onClick:E,children:"\u2b05\ufe0f Send left"}),Object(a.jsx)("div",{className:"sidebar-header-gap"}),Object(a.jsx)("div",{className:"sidebar-header-button",onClick:function(){c()},children:"\u274e Close"})]}),Object(a.jsx)(vt,{value:k||0,labels:b.length?b:Tt,onChange:w}),Object(a.jsx)(St,{gameState:t,updaters:n,tabName:_})]})]})}var _t=new he((function(){return new He({}).create(+new Date)}));var Ct=function(){var e=Object(i.useState)((function(){return _t.get()})),t=Object(u.a)(e,2),n=t[0],r=t[1],o=Object(i.useMemo)((function(){return Q(r)}),[r]),c=Object(u.a)(o,2),s=c[0],l=c[1],h=Object(i.useMemo)((function(){return te(_t.get(),s)}),[s]),f=Object(i.useMemo)((function(){return[n,h,l]}),[n,h,l]);return Object(i.useEffect)((function(){console.log("maybe toggling strategic view"),n.intent.newIntent.TOGGLE_STRATEGIC_VIEW&&h.playerUI.isPixiHidden.enqueueUpdate((function(e){return!e}))}),[n.intent.newIntent.TOGGLE_STRATEGIC_VIEW,h]),Object(i.useEffect)((function(){console.log("maybe toggling sidebar"),n.intent.newIntent.TOGGLE_SIDEBAR&&h.playerUI.isSidebarOpen.enqueueUpdate((function(e){return!e}))}),[n.intent.newIntent.TOGGLE_SIDEBAR,h]),Object(a.jsxs)("div",{className:d()({App:!0}),children:[Object(a.jsxs)("div",{className:"entire-area",children:[Object(a.jsx)(G.Provider,{value:f,children:Object(a.jsx)(je,{hidden:n.playerUI.isPixiHidden})}),Object(a.jsx)(ft,{gameState:n,updaters:h})]}),Object(a.jsx)("div",{className:"debug-overlay",children:Object(a.jsx)(p,{tick:n.tick,windowState:n.windowState})}),Object(a.jsxs)("div",{className:"button-zone",children:[Object(a.jsx)("button",{className:"button-pixi-toggle",style:{},onClick:function(){h.playerUI.isPixiHidden.enqueueUpdate((function(e){return!e}))},children:"Toggle strategic view (hotkey: m)"}),Object(a.jsx)("span",{children:" "}),Object(a.jsx)("button",{onClick:function(){h.playerUI.isSidebarOpen.enqueueUpdate((function(e){return!e}))},children:"Toggle sidebar (hotkey: i)"})]}),Object(a.jsx)(Nt,{gameState:n,updaters:h}),Object(a.jsx)(z,{intent:n.intent,updaters:h.intent}),Object(a.jsx)(xe,{updaters:h.windowState})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(Ct,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},6:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));n(2),n(3),n(48);var a=Math.pow(2,32);function i(e){var t=(e+a)%a;return t=Math.imul(t,3039394381),t^=t>>>8,t+=1759714724,t^=t<<8,t=Math.imul(t,458671337),((t^=t>>>8)+a)%a}}).call(this,n(14).Buffer)},70:function(e,t,n){}},[[236,1,2]]]);
//# sourceMappingURL=main.57a65374.chunk.js.map